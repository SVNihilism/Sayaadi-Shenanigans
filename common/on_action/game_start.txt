# Empty scope
on_game_start = {
	events = {
		fp1_scandinavian_adventurers.0004	# FP1 - Organise Norse adventurers.
		fp1_scandinavian_adventurers.0011	# FP1 - Corral famous Norse adventurers that haven't done much yet.
		fp1_scandinavian_adventurers.0021	# FP1 - Mark game-start prioritised adventurers.
		#Guaranteed historical artifacts fixed spawning
		debug_portraits.1 					# Debug portraits for animation testing
		# Warcraft
		# easteregg_event.0001				# Charna and Jakub duel.
		WCHEA.2000							# Sets up ancient characters' ages (So the arent 1 year old)
		# End of Warcraft
	}

	effect = {
		# Warcraft
		check_available_government_game_start_effect = yes
		# End of Warcraft
		
		#Epidemics 10 years grace
		set_global_variable = {
			name = start_epidemic_grace
			value = yes
			years = 10
		}
		#Set Cumania name if there is no MPO DLC
		#if = { # Warcraft
		#	limit = {
		#		has_mpo_dlc_trigger = no
		#		current_date >= 1000.1.1
		#	}
		#	title:e_caspian-pontic_steppe = {
		#		set_title_name = cn_cumania
		#	}
		#}
		#Rabbene Gershom outlaws polygamy
		#if = {
		#	limit = {
		#		current_date >= 1000.1.1
		#	}
		#	religion:judaism_religion = {
		#		every_faith = {
		#			limit = {
		#				has_doctrine = temple_authority_rabbinic_doctrine
		#			}
		#			remove_doctrine = doctrine_polygamy
		#			add_doctrine = doctrine_monogamy
		#		}
		#	}
		#}
		### 867 - RADHANITES IN KHAZARIA ###
		#character:74025 = { # Warcraft
		#	if = {
		#		limit = {
		#			is_alive = yes
		#			is_playable_character = yes
		#		}
		#		trigger_event = bookmark.0200
		#	}
		#}
		### 867 - WRATH OF THE NORTHMEN ###
		#Æthelred dying (probably)
		#character:33358 = { # Warcraft
		#	if = {
		#		limit = {
		#			is_alive = yes
		#			is_playable_character = yes
		#		}
		#		trigger_event = {
		#			id = bookmark.0001
		#			days = { 365 730 }
		#		}
		#	}
		#}

		#Alfred the Great becoming the Great
		#character:7627 = { # Warcraft
		#	if = {
		#		limit = {
		#			is_alive = yes
		#			is_playable_character = yes
		#		}
		#		trigger_event = {
		#			id = bookmark.0002
		#			days = 1800 #~5 years
		#		}
		#	}
		#}

		### 867 - THE GREAT ADVENTURERS ###
		#character:251187 = { # Warcraft
		#	if = {
		#		limit = {
		#			is_alive = yes
		#			is_playable_character = yes
		#			AND = {
		#				character:251180 = { is_ai = yes }
		#				character:251181 = {
		#					is_ai = yes
		#					is_alive = yes
		#				}
		#			}
		#		}
		#		trigger_event = {
		#			id = bookmark.0101
		#			days = { 21 35 }
		#		}
		#	}
		#}

		### 1066 - HASAN SABBAH STORY CYCLE ###
		#character:41702 ?= { # Warcraft
		#	if = {
		#		limit = {
		#			is_alive = yes
		##			is_playable_character = yes
		#		}
		#		house = { set_house_head = prev }
		#		trigger_event = {
		#			id = hasan_sabbah.1000
		#			days = 1
		#		}
		#	}
		#}
		### 1066 - EL CID STORY CYCLE ###
		#character:107590 ?= { # Warcraft
		#	if = {
		#		limit = {
		#			cid_story_cycle_start_trigger = yes
		#		}
		#		trigger_event = {
		#			id = cid.0001
		#			days = 1
		#		}
		#	}
		#}
		### 1066 - LOUIS THE GERMAN ###
		#if = {
		#	limit = {
		#		exists = character:90107
		#		current_date >= 1066.1.1
		#	}
		#	character:90107 = { give_nickname = nick_the_german_post_mortem }
		#}

		### 1178 - SIBYLLA ###
		#if = {
		#	limit = {
		#		exists = character:223522
		#		current_date >= 1178.1.1
		#		AND = {
		#			character:223541 = {
		#				is_ai = yes
		#				is_alive = yes
		#			}
		#		}
		#	}
		#	character:223522 = {
		#		trigger_event = {
		#			id = bookmark.0300
		#			days = { 21 28 }
		#		}
		#	}
		#}

		### HRE SETUP ###
		#if = { # Warcraft
		#	limit = { exists = title:e_hre.holder }
		#	add_to_global_variable_list = {
		#		name = hre_elector_list
		#		target = title:c_cologne
		#	}
		#	add_to_global_variable_list = {
		#		name = hre_elector_list
		#		target = title:c_mainz
		#	}
		#	add_to_global_variable_list = {
		#		name = hre_elector_list
		#		target = title:c_trier
		#	}
		#	add_to_global_variable_list = {
		#		name = hre_elector_list
		#		target = title:d_bohemia
		#	}
		#	add_to_global_variable_list = {
		#		name = hre_elector_list
		#		target = title:d_east_franconia
		#	}
		#	add_to_global_variable_list = {
		#		name = hre_elector_list
		#		target = title:d_ostmark
		#	}
		#	add_to_global_variable_list = {
		#		name = hre_elector_list
		#		target = title:d_angria
		#	}
		#	hre_elector_list_save_effect = yes
		#	hre_margraves_effect = yes
		#}

		### ARMENIAN SETUP ###
		#title:e_byzantium.holder ?= { # Warcraft
		#	every_vassal = {
		#		limit = {
		#			government_has_flag = government_is_feudal
		#			vassal_contract_has_modifiable_obligations = yes
		#			faith = faith:armenian_apostolic
		#		}
		#		vassal_contract_set_obligation_level = { type = religious_rights level = 1 }
		#		set_subject_contract_modification_blocked = no
		#	}
		#}
		#title:e_arabia.holder ?= {
		#	every_vassal = {
		#		limit = {
		#			government_has_flag = government_is_feudal
		#			vassal_contract_has_modifiable_obligations = yes
		#			faith = faith:armenian_apostolic
		#		}
		#		vassal_contract_set_obligation_level = { type = feudal_government_taxes level = 3 }
		#		vassal_contract_set_obligation_level = { type = feudal_government_levies level = 2 }
		#		vassal_contract_set_obligation_level = { type = jizya_special_rights level = 1 }
		#		set_subject_contract_modification_blocked = no
		#	}
		#}

		### CORONATION LOCATION SETUP ###
		if = {
			limit = {
				#current_date >= 1066.1.1
				has_dlc_feature = coronations
			}
			# Stormwind (Stormwind)
			province:1 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Ironforge (Ironforge)
			province:102 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Suramar (Suramar)
			province:6440 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Stromgarde (Stromgarde)
			province:216 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Boralus (Kul Tiras)
			province:2179 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Gilneas (Gilneas)
			province:252 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Gnomeregan (Gnomeregan)
			province:146 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Blackrock_depths, Blackrock mountain (Shadowforge)
			province:103 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Lordaeron (Lordaeron)
			province:269 = {
				add_province_modifier = coronation_long_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 10
				}
			}
			# Golden Throne, Dazar'alor (Zandalar)
			province:2232 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Junkwatt (Mechagon)
			province:1155 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Silvermoon (Quel'thalas)
			province:344 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Zul'aman (Zul'aman)
			province:254 = {
				add_province_modifier = coronation_long_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 10
				}
			}
			# Zul'gurub (Zul'gurub)
			province:50 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Gundrak (Zul'drak)
			province:754 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Zul'farrak (Zul'farrak)
			province:1591 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Orgrimmar (Durotar)
			province:1700 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Sethraliss (Voldun)
			province:2260 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Dalaran (Dalaran)
			province:250 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
			# Alterac (Alterac)
			province:243 = {
				add_province_modifier = coronation_tradition_modifier 
				set_variable = {
					name = coronation_tradition_location
					value = 5
				}
			}
		}
		#if = {
		#	limit = {
		#		current_date >= 1178.1.1
		#		has_dlc_feature = coronations
		#	}
			# Marrakesh (Maghreb)
		#	province:4718 = {
		#		add_province_modifier = coronation_tradition_modifier 
		#		set_variable = {
		#			name = coronation_tradition_location
		#			value = 5
		#		}
		#	}
			# Karakorum (Mongolia)
		#	province:1457 = {
		#		add_province_modifier = coronation_tradition_modifier 
		#		set_variable = {
		#			name = coronation_tradition_location
		#			value = 5
		#		}
		#	}
		#}

		### Every nomad and herder in the Steppe Region becomes tribal if DLC not enabled, pre-lobby history setup ###
		if = {
			limit = {
				has_mpo_dlc_trigger = no
			}
			# Change Nomad and Herder Holdings to Tribal Holdings for Tribals
			every_province = {
				limit = {
					OR = {
						has_holding_type = nomad_holding
						has_holding_type = herder_holding
					}
				}
				set_holding_type = tribal_holding
				if = {
					limit = {
						county.holder.capital_province ?= this
					}
					county.holder ?= {
						if = {
							limit = {
								NOT = {
									has_government = tribal_government
								}
							}
							change_government = tribal_government
						}
					}
				}
			}
		}

		setup_tributaries_effect = yes # defined in 00_tributary_setup_effect.txt

		### RELIGIOUS THINGS ###
		# Warcraft
		every_religion_global = {
			limit = { like_islam_religion_trigger = yes }
			every_faith = {
				every_holy_site = {
					limit = {
						title_province = {
							has_special_building_slot = no
						}
					}
					title_province = {
						add_special_building_slot = holy_site_mosque_01
					}
				}
			}
		}
		# Warcraft
		every_religion_global = {
			limit = { like_christianity_religion_trigger = yes }
			every_faith = {
				every_holy_site = {
					limit = {
						title_province = {
							has_special_building_slot = no
						}
					}
					title_province = {
						add_special_building_slot = holy_site_cathedral_01
					}
				}
			}
		}
		# Warcraft
		every_religion_global = {
			limit = {
				OR = {
					like_hinduism_religion_trigger = yes
					like_buddhism_religion_trigger = yes
					like_jainism_religion_trigger = yes
					like_tani_religion_trigger = yes
					like_bon_religion_trigger = yes
				}
			}
			every_faith = {
				every_holy_site = {
					limit = {
						title_province = {
							has_special_building_slot = no
						}
					}
					title_province = {
						add_special_building_slot = holy_site_indian_grand_temple_01
					}
				}
			}
		}
		every_religion_global = {
			limit = {
				like_pagan_religion_trigger = yes
			}
			every_faith = {
				every_holy_site = {
					limit = {
						title_province = {
							has_special_building_slot = no
						}
					}
					title_province = {
						add_special_building_slot = holy_site_pagan_grand_temple_01
					}
				}
			}
		}
		every_religion_global = {
			every_faith = {
				every_holy_site = {
					limit = {
						title_province = {
							has_special_building_slot = no
						}
					}
					title_province = {
						add_special_building_slot = holy_site_other_grand_temple_01
					}
				}
			}
		}

		# Warcraft
		if = {
			limit = { game_start_date < 605.5.2 }
			title:d_theramore = { set_title_name = rocky_island_custom_name generate_coa = yes }
			title:c_theramore = { set_title_name = rocky_island_custom_name generate_coa = yes }
			title:b_theramore = { set_title_name = rocky_island_custom_name }
		}
		else = { title:d_theramore = { set_color_from_title = title:b_theramore } }

		if = { 
			limit = { game_start_date >= 583.1.1 }
			set_global_variable = { 
				name = arthas_character
				value = character:60003
			}
		}
		
		
		### Thunder King Crisis
		if = { # Make sure Thunder King wont spawn on this gamerule
			limit = {
				has_game_rule = wc_thunder_king_crisis_never
			}
			set_global_variable = {
				name = no_thunder_king
				value = yes
			}
			debug_log = "Thunder King will never spawn this game"
		}
		else_if = { # Roll wether Thunder King will ever spawn at all
			limit = {
				has_game_rule = wc_thunder_king_crisis_default
			}
			random = { # Chance he will never spawn randomly
				chance = 40
				set_global_variable = {
					name = no_thunder_king
					value = yes
				}
				debug_log = "Thunder King will never spawn this game"
			}
		}

		# Warcraft, This launches Scarlet/Argent Event chain in 605 - Ikari
		if = {
			limit = { game_start_date >= 605.6.6 }
			title:k_order_of_the_silver_hand.holder = {
				trigger_event = {
					id = scarlet.1000
					years = { 1 2 }
				}
			}
			# Sally Whitemane Conversion
			character:60572 = {
				set_character_faith_with_conversion = faith:scarletism
			}
		}

		# Warcraft, This spawns the scourge on 602.1.1 for the 583 start date - Ikari
		if = {
			limit = { game_start_date = 583.1.1 }
			trigger_event = {
				id = WCCSC.01
				years = 19
			}
		}

		### GRANDEUR ###
		#Royal Court: Set starting Grandeur to be the same as Expected
		if = {
			limit = {
				has_dlc_feature = royal_court
			}
			every_character_with_royal_court = {
				set_current_court_grandeur = court_grandeur_minimum_expected
				apply_hold_court_grace_effect = yes
				# Stops Hold Court reminders at game start
				set_variable = {
					name = last_hold_court_date
					value = current_year
				}
			}
		}
		# Warcraft - Removed struggle stuff

		### REGENCIES ###
		# Pre-defined historic regencies setup.
		## NOTE: we do these first to avoid feed messages getting weird due to regents being replaced immediately after getting their position.
		# character:40905 = { designate_diarch = character:40376 }
		# remove_generated_diarch_consequences_effect = {
		# 	NEW_DIARCH = character:40376
		# 	LIEGE = character:40905
		# }
		# HERE WARCRAFT REGENCIES like this
		
		if = {
			limit = { game_start_date = 583.1.1 }
			# Designate some regents.
			## King Llane of Stormwind & Anduin Lothar
			character:2 = { try_start_diarchy = regency designate_diarch = character:1008 }
			remove_generated_diarch_consequences_effect = {
				NEW_DIARCH = character:1008
				LIEGE = character:2
			}
			character:2 = { set_diarch = character:1008 }
		}
		if = {
			limit = { game_start_date < 610.1.15 game_start_date > 586.1.1 }
			# Designate some regents.
			## King Varian of Stormwind & Bolvar Fordragon
			character:8 = { try_start_diarchy = regency designate_diarch = character:60686 }
			remove_generated_diarch_consequences_effect = {
				NEW_DIARCH = character:60686
				LIEGE = character:8
			}
			character:8 = { set_diarch = character:60686 }
		}
		if = {
			limit = { game_start_date < 603.7.29 game_start_date > 583.1.1 }
			# Designate some regents.
			## King Anasterian of Quel'thalas & Lor'themar Theron
			character:42002 = { try_start_diarchy = regency designate_diarch = character:42075 }
			remove_generated_diarch_consequences_effect = {
				NEW_DIARCH = character:42075
				LIEGE = character:42002
			}
			character:42002 = { set_diarch = character:42075 }
		}
		if = {
			limit = {
				game_start_date > 583.1.1
				game_start_date < 603.7.29
				character:42003 = { top_liege = this }
			}
			# Designate some regents.
			## King Kael'thas of Quel'thalas & Lor'themar Theron
			character:42003 = { try_start_diarchy = regency designate_diarch = character:42075 }
			remove_generated_diarch_consequences_effect = {
				NEW_DIARCH = character:42075
				LIEGE = character:42003
			}
			character:42003 = { set_diarch = character:42075 }
		}
		if = {
			limit = { game_start_date < 604.1.1 game_start_date > 591.11.1 }
			character:10014 = { designate_diarch = character:430000 }
			remove_generated_diarch_consequences_effect = {
				NEW_DIARCH = character:430000
				LIEGE = character:10014
			}
			character:10014 = { set_diarch = character:430000 }
		}
		if = {
			limit = { game_start_date = 605.6.6 }
			character:10014 = { designate_diarch = character:60003 }
			remove_generated_diarch_consequences_effect = {
				NEW_DIARCH = character:60003
				LIEGE = character:10014
			}
			character:10014 = { set_diarch = character:60003 }
		}
		every_ruler = { # PUT EVERY_RULER TYPE STUFF HERE FOR PERFORMANCE REASONS
			# Set up anyone who should be in a regency at start whether we have sources or not.
			## If you start as a child, incapable, or imprisoned, you get a regency.
			if = {
				limit = {
					OR = {
						is_adult = no
						is_incapable = yes
						is_imprisoned = yes
					}
				}
				# We don't want to check over so many characters *twice*, so we check again inside the block to determine what type of regency to put 'em in.
				## Temporary Regencies.
				if = {
					limit = { is_imprisoned = yes }
					trigger_event = {
						id = diarchy.0001
						delayed = yes
					}
				}
				## Entrenched Regencies.
				else = {
					trigger_event = {
						id = diarchy.0011
						delayed = yes
					}
				}
			}

			# Set Coronation laws for everyone
			if = {
				limit = {
					coronation_trigger = yes
				}
				if = {
					limit = {
						highest_held_title_tier = tier_kingdom
					}
					add_realm_law_skip_effects = crowned_king
					set_variable = crowned_king_var
				}
				else_if = {
					limit = {
						highest_held_title_tier > tier_kingdom
						#trigger_if = { # Heinich IV crowned April 1st 1084 by Pope Clement III
						#	limit = { has_title = title:e_hre }
						#	NOT = { game_start_date = 1066.9.15 }
						#}
					}
					add_realm_law_skip_effects = crowned_emperor
					set_variable = crowned_emperor_var
				}
			}

			# Admin - Let's give existing governors the Governor trait on game start
			if = {
				limit = {
					is_governor = yes
					NOT = { has_trait = governor }
					OR = {
						government_allows = administrative
						government_is_japanese_trigger = yes
					}
				}
				add_trait = governor
				add_trait_xp = {
					trait = governor
					value = {
						add = primary_title.title_held_years
						multiply = 2
						if = {
							limit = {
								age >= 50
								has_government = japan_administrative_government
							}
							add = {
								value = age
								divide = 4
							}
						}
					}
				}
			}
			# Clean up TGP governments is the Expansion is not enabled
			if = {
				limit = { has_tgp_dlc_trigger = no }
				# TGP: Clean up maritime tribal govs and revert them to non-dlc tribals
				if = {
					limit = {
						government_has_flag = government_is_wanua
					}
					change_government = tribal_government
				}
				# TGP: Clean up mandala govs and revert them to non-dlc feudals
				else_if = {
					limit = {
						government_has_flag = government_is_mandala
					}
					change_government = feudal_government
				}
				### Every Celestial/Meritocratic/Japanese Government becomes feudal if DLC not enabled, pre-lobby history setup ###
				else_if = {
					limit = {
						OR = {
							has_government = celestial_government
							has_government = meritocratic_government
							has_government = steppe_admin_government
							has_government = japan_administrative_government
							has_government = japan_feudal_government
						}
					}
					change_government = feudal_government

				}
				if = {
					limit = {
						any_held_title = {
							is_noble_family_title = yes
						}
					}
					every_held_title = {
						limit = {
							is_noble_family_title = yes
							title_domicile ?= {
								OR = {
									is_domicile_type = japanese_manor
									is_domicile_type = east_asian_estate
								}
							}
						}
						save_temporary_scope_as = family_title
						prev = { destroy_title = scope:family_title }
					}
				}
			}
			# TGP: Adjust China's starting laws
			else_if = {
				limit = {
					realm_law_use_celestial_bureaucracy = yes
				}
				if = {
					limit = {
						game_start_date >= 1066.9.15
					}
					add_realm_law_skip_effects = celestial_bureaucracy_2
					if = {
						limit = {
							top_liege != this
						}
						add_realm_law_skip_effects = celestial_army_vassal_law_2
					}
					else = {
						add_realm_law_skip_effects = celestial_army_liege_law_2 # Let's give them the matching army level as well
					}
				}
			}
			if = {
				limit = {
					has_domicile = yes
					any_held_title = {
						is_noble_family_title = yes
					}
				}
				if = {
					limit = {
						is_landed = yes
						domicile.domicile_location != this.capital_province
					}
					random_held_title = {
						limit = {
							is_noble_family_title = yes
						}
						set_capital_county = prev.capital_county
					}
					domicile ?= {
						move_domicile = prev.capital_province
					}
				}
				if = {
					limit = {
						tgp_is_any_minister = yes
					}
					random_held_title = {
						limit = {
							tier = tier_empire
						}
						set_capital_county = prev.top_liege.capital_county
					}
					random_held_title = {
						limit = {
							is_noble_family_title = yes
						}
						set_capital_county = prev.top_liege.capital_county
					}
					domicile ?= {
						move_domicile = prev.top_liege.capital_province
					}
				}
			}
		}
		
		every_ruler = { # Warcraft
			if = {
				limit = { NOT = { has_trait = race } }
				copy_race_effect = { CHARACTER = this }
				trigger_race_giving_no_gene_effect = yes
			}
		}
		
		# Stormwind name game rule
		title:k_stormwind = {
			if = {
				limit = {
					has_game_rule = azeroth_name_of_stormwind
				}
				set_title_name = e_azeroth
			}
			else_if = {
				limit = {
					has_game_rule = azerothien_name_of_stormwind
				}
				set_title_name = k_azerothien
			}
		}
		culture:azerothian = {
			if = {
				limit = {
					has_game_rule = azeroth_name_of_stormwind
				}
				set_culture_name = {
					noun = azerothian_alt
					collective_noun = azerothian_alt_collective_noun
					prefix = azerothian_alt_prefix
				}
			}
			else_if = {
				limit = {
					has_game_rule = azerothien_name_of_stormwind
				}
				set_culture_name = {
					noun = azerothien
					collective_noun = azerothien_collective_noun
					prefix = azerothien_prefix
				}
			}
		}
		title:e_azeroth = {
			if = {
				limit = {
					has_game_rule = azerothien_name_of_stormwind
				}
				set_title_name = k_azerothien
			}
		}
		# DYNASTIC CYCLE SETUP
		situation:dynastic_cycle ?= {
			title:h_pandaria = {
				set_variable = {
					name = years_since_imperial_examination
					value = 0
				}
			}
			if = {
				limit = { game_start_date < 868.1.1 }
				tgp_set_wuking_element_effect = { ELEMENT = earth } # Tang
				every_situation_sub_region = {
					add_takeover_phase_points = {
					   phase = situation_dynastic_cycle_phase_chaos
					   points = 800
					}
				}
			}
			else = {
				tgp_set_wuking_element_effect = { ELEMENT = fire } # Song
			}
		}
		setup_tributaries_effect = yes # defined in 00_tributary_setup_effect.txt
		# Sort custom regencies.
		## Fatimid Caliphate - basically stuck in the back-end of an entrenched regencies from game start.
		#if = {
		#	limit = { exists = character:3096 }
		#	character:3096 = { trigger_event = diarchy.0012 }
		#}
		#else_if = {
		#	limit = { exists = character:188912 }
		#	character:188912 = { trigger_event = diarchy.0012 }
		#}

		### FERTILE LANDS ###
		# For deserts that are supposed to be very fertile
		# title:c_taizz = { add_county_modifier = fertile_desert_mountains_modifier }
		# title:c_mandab = { add_county_modifier = fertile_desert_mountains_modifier }
		# title:c_zabid = { add_county_modifier = fertile_desert_mountains_modifier }
		# title:c_sanaa = { add_county_modifier = fertile_desert_mountains_modifier }
		# title:c_dathina = { add_county_modifier = fertile_desert_mountains_modifier }

		### HENDEKAPOLIS ###
		#title:c_ionia = { add_county_modifier = dodekapolis_modifier }
		#title:c_chios = { add_county_modifier = dodekapolis_modifier }
		#title:c_aeolis = { add_county_modifier = dodekapolis_modifier }
		#title:c_lesbos = { add_county_modifier = dodekapolis_modifier }

		### GREECE BACKWATER COUNTIES ###
		#if = {
		#	limit = { has_ep3_dlc_trigger = yes }
		#	title:c_laconia = { add_county_modifier = backwater_county_modifier }
		#	title:c_messenia = { add_county_modifier = backwater_county_modifier }
		#	title:c_korinthos = { add_county_modifier = backwater_county_modifier }
		#	title:c_achaia = { add_county_modifier = backwater_county_modifier }
		#	title:c_cephalonia = { add_county_modifier = backwater_county_modifier }
		#	title:c_attica = { add_county_modifier = backwater_county_modifier }
		#	title:c_boeotia = { add_county_modifier = backwater_county_modifier }
		#	title:c_aetolia = { add_county_modifier = backwater_county_modifier }
		#	title:c_naxos = { add_county_modifier = backwater_county_modifier }
		#	title:c_euboea = { add_county_modifier = backwater_county_modifier }
		#	title:c_neopatras = { add_county_modifier = backwater_county_modifier }
		#	title:c_demetrias = { add_county_modifier = backwater_county_modifier }
		#	title:c_thessaliotis = { add_county_modifier = backwater_county_modifier }
		#	title:c_thessalia = { add_county_modifier = backwater_county_modifier }
		#	title:c_epeiros = { add_county_modifier = backwater_county_modifier }
		#	title:c_buthrotum = { add_county_modifier = backwater_county_modifier }
		#	title:c_veria = { add_county_modifier = backwater_county_modifier }
		#	title:c_metzovo = { add_county_modifier = backwater_county_modifier }
		#	title:c_chalkidike = { add_county_modifier = backwater_county_modifier }
		#	title:c_thessalonika = { add_county_modifier = backwater_county_modifier }
		#	title:c_serres = { add_county_modifier = backwater_county_modifier }
		#	title:c_mosynopolis = { add_county_modifier = backwater_county_modifier }
		#	title:c_ohrid = { add_county_modifier = backwater_county_modifier }
		#	title:c_antipatreia = { add_county_modifier = backwater_county_modifier }
		#	title:c_dyrrachion = { add_county_modifier = backwater_county_modifier }
		#	title:c_avlonas = { add_county_modifier = backwater_county_modifier }
		#}

		### Pandidakterion IN CONSTANTINOPLE ###
		#if = {
		#	limit = {
		#		has_ep3_dlc_trigger = yes
		#		current_date >= 1046.1.1
		#	}
		#	title:c_byzantion = { add_county_modifier = pandidakterion_university_modifier }
		#}

		### Varangian Guard ###
		#if = {
		#	limit = {
		#		has_ep3_dlc_trigger = yes
		#		current_date >= 988.1.1
		#	}
		#	title:e_byzantium = { set_variable = founded_varangian_guard }
		#}

		#if = {
		#	limit = {
		#		has_dlc_feature = hybridize_culture
		#		NOT = {
		#			has_dlc_feature = khans_of_the_steppe
		#		}
		#	}
		#	culture:mongol = {
		#		add_culture_tradition = tradition_malleable_invaders
		#	}
		#	culture:khitan = {
		#		add_culture_tradition = tradition_malleable_invaders
		#	}
		#	culture:jurchen = {
		#		add_culture_tradition = tradition_malleable_invaders
		#	}
		#	culture:cuman = {
		#		add_culture_tradition = tradition_malleable_invaders
		#	}
		#	culture:bolghar = {
		#		add_culture_tradition = tradition_malleable_invaders
		#	}
		#	culture:bashkir = {
		#		add_culture_tradition = tradition_malleable_invaders
		#	}
		#	culture:karluk = {
		#		add_culture_tradition = tradition_malleable_invaders
		#	}
		#	culture:shatuo = {
		#		add_culture_tradition = tradition_malleable_invaders
		#	}
		#}

		#if = {
		#	limit = {
		#		NOT = {
		#			has_dlc_feature = khans_of_the_steppe
		#		}
		#	}
		#	culture:hunnic = { add_culture_tradition = tradition_horse_lords add_culture_tradition = tradition_steppe_tolerance }
		#	culture:saka = { add_culture_tradition = tradition_horse_lords }
		#	culture:alan = { add_culture_tradition = tradition_horse_lords add_culture_tradition = tradition_steppe_tolerance }
		#	culture:mongol = { add_culture_tradition = tradition_horse_lords add_culture_tradition = tradition_steppe_tolerance }
		#	culture:buryat = { add_culture_tradition = tradition_horse_lords add_culture_tradition = tradition_steppe_tolerance }
		#	culture:oirat = { add_culture_tradition = tradition_horse_lords }
		#	culture:naiman = { add_culture_tradition = tradition_horse_lords add_culture_tradition = tradition_steppe_tolerance }
		#	culture:kerait = { add_culture_tradition = tradition_horse_lords add_culture_tradition = tradition_steppe_tolerance }
		#	culture:khitan = { add_culture_tradition = tradition_horse_lords }
		#	culture:tuyuhun = { add_culture_tradition = tradition_horse_lords }
		#	culture:jurchen = { add_culture_tradition = tradition_horse_lords }
		#	culture:cuman = { add_culture_tradition = tradition_horse_lords }
		#	culture:khazar = { add_culture_tradition = tradition_horse_lords add_culture_tradition = tradition_steppe_tolerance }
		#	culture:bolghar = { add_culture_tradition = tradition_horse_lords }
		#	culture:bashkir = { add_culture_tradition = tradition_horse_lords }
		#	culture:avar = { add_culture_tradition = tradition_horse_lords }
		#	culture:karluk = { add_culture_tradition = tradition_horse_lords add_culture_tradition = tradition_steppe_tolerance }
		#	culture:kimek = { add_culture_tradition = tradition_horse_lords }
		#	culture:kipchak = { add_culture_tradition = tradition_horse_lords }
		#	culture:laktan = { add_culture_tradition = tradition_horse_lords }
		#	culture:kirghiz = { add_culture_tradition = tradition_horse_lords }
		#	culture:yughur = { add_culture_tradition = tradition_horse_lords add_culture_tradition = tradition_steppe_tolerance }
		#	culture:uriankhai = { add_culture_tradition = tradition_horse_lords }
		#	culture:chuvash = { add_culture_tradition = tradition_horse_lords }
		#	culture:ongud = { add_culture_tradition = tradition_horse_lords }
		#	culture:turkmen = { add_culture_tradition = tradition_horse_lords }
		#	culture:mogyer = { add_culture_tradition = tradition_horse_lords }
		#	culture:pecheneg = { add_culture_tradition = tradition_horse_lords }
		#	culture:ongud = { add_culture_tradition = tradition_steppe_tolerance }
		#	culture:uyghur = { add_culture_tradition = tradition_steppe_tolerance }
			#culture:turkish = { add_culture_tradition = tradition_horse_lords }
		#}

		### DEBUG GLOBAL VARIABLES ###
		# We set these here so that they present nicely and you can see when some variables register zero.

		# FP3 Struggle.
		# if = {
		# 	limit = { gather_debug_variables_for_persian_struggle_trigger = yes }
		# 	# ENDING
		# 	set_global_variable = {
		# 		name = sp_end_date
		# 		value = 0
		# 	}
		# 	# There's also fp3_struggle_ending; we don't track that here because it has functional usage that depends on it existing or not, so it's not a debug variable.

		# 	# PHASES
		# 	set_global_variable = {
		# 		name = sp_phase_unrest
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_phase_stabil
		# 		value = 0
		# 	}

		# 	# UNREST
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_yearly_influential_house_is_antagonistic_major
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_yearly_influential_house_is_antagonistic_medium
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_yearly_influential_house_is_antagonistic_minor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_yearly_influential_house_is_antagonistic_minimal
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_becomes_rival_supporter_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_gain_claim_on_title_fp3
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_usurp_title_fp3
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_cadet_branch_created
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_supporter_forced_conversion
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_execute_supporter
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_imprison_supporter
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_unnatural_death_supporter
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_reveal_secret_supporter
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_turn_supporter_into_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_forming_alliance_between_detractor_uninvolved_rulers
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_detractor_win_unfair_war_within_the_region
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_detractor_win_fair_war_within_the_region
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_detractor_declare_unfair_war_within_the_region
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_detractor_declare_fair_war_within_the_region
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_unrest_catalyst_became_detractor_fp3
		# 		value = 0
		# 	}
		# 	# STABILISATION
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_yearly_influential_house_is_harmonious_major
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_yearly_influential_house_is_harmonious_medium
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_yearly_influential_house_is_harmonious_minor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_yearly_influential_house_is_harmonious_minimal
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_learned_new_language_important
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_vassalize_independent_ruler
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_invite_involved_as_honorary_guests_to_feast_hunt
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_supporter_win_unfair_war_within_the_region
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_supporter_win_fair_war_within_the_region
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_supporter_declare_unfair_war_within_the_region
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_supporter_declare_fair_war_within_the_region
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_install_loyalist_cb
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_imprison_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_execute_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_unnatural_death_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_reveal_secret_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_detractor_forced_conversion
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_turn_detractor_into_supporter
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_gain_struggle_titles_from_interlopers_uninvolved
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_stabil_catalyst_became_supporter_fp3
		# 		value = 0
		# 	}
		# 	# CONCESSION
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_missing_caliphate_or_arabian_empire
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_caliph_or_emperor_loses_revolt_war
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_caliph_or_emperor_accepts_faction_demands
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_caliph_died_violently
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_caliph_died_naturally
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_war_ends_in_white_peace_between_supporter_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_became_best_friend_soulmate_supporter_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_became_friend_lover_supporter_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_forming_alliance_between_supporter_detractor_rulers
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_abandon_hook_on_supporter_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_grants_pardon_supporter_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_release_supporter_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_ransom_supporter_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_grants_vassal_to_de_jure_liege_supporter_detractor
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_gift_supporter_detractor_ruler
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_interloper_uninvolved_gain_struggle_titles
		# 		value = 0
		# 	}
		# 	set_global_variable = {
		# 		name = sp_concession_catalyst_raided_involved
		# 		value = 0
		# 	}
		# }

		# UNITY CONFIG
		## 867.
		#if = {
			#limit = { game_start_date = 867.1.1 }
			# Twiddle some starting unities.
			## The Abassids are in the middle of a self-killing frenzy, so we lower theirs substantially.
			#house:house_abbasid ?= {
			#	add_unity_value = {
			#		value = -100
			#		# This is from historical circumstances, so we just do use the house head.
			#		character = house_head
			#		desc = clan_unity_historical_circumstances.desc
			#	}
			#}
			## The Samanids are juuuuust about to get started on killing each other over who gets to lead Transoxiana.
			#house:house_samanid ?= {
			#	add_unity_value = {
			#		value = -40
			#		# This is from historical circumstances, so we just do use the house head.
			#		character = house_head
			#		desc = clan_unity_historical_circumstances.desc
			#	}
			#}
			## The Afrighids (both of them) are having fairly few arguments because only one of them can speak and it's very easy to manage relations with a baby.
			#dynasty:1042112.dynast.house ?= {
			#	add_unity_value = {
			#		value = 50
			#		# This is from historical circumstances, so we just do use the house head.
			#		character = house_head
			#		desc = clan_unity_historical_circumstances.desc
			#	}
			#}
			## The Tahirids are scattered but actually get along quite well and support each other politically (mostly).
			#dynasty:811.dynast.house ?= {
			#	add_unity_value = {
			#		value = 100
			#		# This is from historical circumstances, so we just do use the house head.
			#		character = house_head
			#		desc = clan_unity_historical_circumstances.desc
			#	}
			#}
			## The Umayyads are having something of a renaissance.
			#dynasty:597.dynast.house ?= {
			#	add_unity_value = {
			#		value = 100
					# This is from historical circumstances, so we just do use the house head.
			#		character = house_head
			#		desc = clan_unity_historical_circumstances.desc
			#	}
			#}
		#}
		# LEGITIMACY CONFIG
		## 867.
		#if = {
		#	limit = { game_start_date = 867.1.1 }
			## Basileus Basileios was actually elected, so he's technically legitimate, but starts at level 2. With this he should be level 3.
		#	character:1700 = {
		#		add_legitimacy = major_legitimacy_gain
		#	}
		#}

		# Cultural setup
		#if = {
		#	limit = {
		#		game_start_date = 1178.10.1
		#	}
		#	culture:norman = {
		#		set_name_list = name_list_late_norman
		#	}
		#}

		### EP3 BYZANTIUM IMPORTANT COUNTIES ###
		# Will adapt to Warcraft
		# if = {
		# 	limit = { has_ep3_dlc_trigger = yes }
		# 	title:c_stromgarde = {
		# 		set_important_location = {
		# 			title = title:e_arathor
		# 			enter_realm_event = ep3_emperor_yearly.2000
		# 		}
		# 	}
		# 	title:c_covescale = {
		# 		set_important_location = {
		# 			title = title:e_empire_of_zul
		# 			enter_realm_event = ep3_emperor_yearly.2000
		# 		}
		# 	}
		# 	title:c_gundrak = {
		# 		set_important_location = {
		# 			title = title:e_drakkari
		# 			enter_realm_event = ep3_emperor_yearly.2000
		# 		}
		# 	}
		# 	title:c_zulgurub = {
		# 		set_important_location = {
		# 			title = title:e_gurubashi
		# 			enter_realm_event = ep3_emperor_yearly.2000
		# 		}
		# 	}
		# 	title:c_mogushan = {
		# 		set_important_location = {
		# 			title = title:e_pandaria_empire
		# 			enter_realm_event = ep3_emperor_yearly.2000
		# 		}
		# 	}
		# }

		# MPO Tribes of the North cultrad mechanic
		# if = {
		# 	limit = {
		# 		has_dlc_feature = khans_of_the_steppe
		# 	}
		# 	every_county_in_region = {
		# 		region = mpo_region_permafrost
		# 		if = {
		# 			limit = {
		# 				holder.culture ?= culture
		# 				culture = {
		# 					has_cultural_parameter = permafrost_modifier_mechanic
		# 				}
		# 			}
		# 			add_county_modifier = mpo_siberian_permafrost_modifier
		# 		}
		# 		else = {
		# 			add_county_modifier = mpo_siberian_permafrost_modifier_bad
		# 		}

		# 	}
		# }

		# Byzantine name game rule
		#title:e_byzantium = {
		#	if = {
		#		limit = {
		#			has_game_rule = eastern_rome_name_of_byzantium
		#		}
		#		set_title_name = e_eastern_roman_empire
		#	}
		#	else_if = {
		#		limit = {
		#			has_game_rule = roman_empire_name_of_byzantium
		#		}
		#		set_title_name = h_roman_empire
		#	}
		#	else_if = {
		#		limit = {
		#			has_game_rule = romania_name_of_byzantium
		#		}
		#		set_title_name = e_romania_empire
		#	}
		#	else_if = {
		#		limit = {
		#			has_game_rule = empire_of_the_greeks_name_of_byzantium
		#		}
		#		set_title_name = e_empire_of_the_greeks
		#	}
		#	else_if = {
		#		limit = {
		#			has_game_rule = rhomaion_name_of_byzantium
		#		}
		#		set_title_name = e_rhomaion
		#	}
		#	else_if = {
		#		limit = {
		#			has_game_rule = unholy_roman_empire_name_of_byzantium
		#		}
		#		set_title_name = e_unholy_roman_empire
		#	}
		#} #Warcraft

		# Remove Coronation Doctrine if you don't have the DLC
		if = {
			limit = {
				has_ach_dlc_trigger = no
			}
			every_religion_global = {
				every_faith = {
					switch = {
						trigger = has_doctrine
						doctrine_no_anointment = { remove_doctrine = doctrine_no_anointment }
						doctrine_anointment_permitted = { remove_doctrine = doctrine_anointment_permitted }
						doctrine_imperial_anointment = { remove_doctrine = doctrine_imperial_anointment }
					}
				}
			}
		}

		# Set Coronation laws for everyone
		if = {
			limit = {
				has_ach_dlc_trigger = yes
			}
			every_ruler = {
				limit = {
					coronation_trigger = yes
					age >= 12
					# Warcraft
				}
				save_temporary_scope_as = ruler
				if = {
					limit = {
						highest_held_title_tier > tier_kingdom
						NOT = {
							has_any_shunned_or_criminal_trait_in_faith_trigger = {
								CHARACTER = scope:ruler
								FAITH = scope:ruler.faith
							}
							faith = { has_doctrine = doctrine_no_anointment }
						}
					}
					if = {
						limit = {
							NOT = {
								has_game_rule = coronation_laws_off
								has_realm_law = crowned_emperor
							}
						}
						add_realm_law_skip_effects = crowned_emperor
					}
					set_variable = crowned_emperor_var
				}
				else = {
					if = {
						limit = {
							NOT = {
								has_game_rule = coronation_laws_off
								has_realm_law = crowned_king
							}
						}
						add_realm_law_skip_effects = crowned_king
					}
					set_variable = crowned_king_var
				}
			}
		}

		# TGP: extra legitimacy for the Hegemon, so you don't fold over immediately
		if = {
			limit = { has_tgp_dlc_trigger = yes }
			title:h_pandaria.holder = { #Warcraft
				# and even more for the Song, as they were in a pretty good shape on our start dates
				if = {
					limit = {
						situation:dynastic_cycle ?= {
							OR = {
								situation_current_phase = situation_dynastic_cycle_phase_stability_expansion
								situation_current_phase = situation_dynastic_cycle_phase_stability_advancement
							}
						}
					}
					add_legitimacy = 4500
				}
				else = {
					add_legitimacy = 3000
				}
			}
		}
		### TGP SILK ROAD INNOVATIONS
		tgp_silk_road_innovation_setup_effect = yes

		set_global_variable = {
			name = natural_disaster_initial_grace_period
			years = natural_disaster_initial_grace_period_years
		}

		### TGP Earthquake Regions # Warcraft
		add_to_global_variable_list = { name = earthquake_region_list target = geographical_region:world_eastern_kingdoms }
		add_to_global_variable_list = { name = earthquake_region_list target = geographical_region:world_pandaria }
		add_to_global_variable_list = { name = earthquake_region_list target = geographical_region:world_northrend }
		add_to_global_variable_list = { name = earthquake_region_list target = geographical_region:world_kalimdor }

		### TGP Flood Regions # Warcraft
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:north_elrendar_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:south_elrendar_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:north_thondroril_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:south_thondroril_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:thandol_span_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:nazferiti_north_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:nazferiti_south_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:suramar_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:azsuna_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:stormheim_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:shattered_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:slicky_stream_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:yan_zhe_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:daggercap_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:lumberjack_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:daggerspine_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:north_southfury_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:south_southfury_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:vir_naal_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:theramore_region }
		add_to_global_variable_list = { name = flood_region_list target = geographical_region:kul_tiras_region }

		##### HISTORICAL HOUSE RELATIONS - deliberately placed above blocs
		tgp_setup_historical_house_relation_effect = yes
		#####  TGP JAPAN #####
		if = {
			limit = { has_tgp_dlc_trigger = yes }
			### DYNASTIES
			tgp_dynasty_house_name_setup_effect = yes
			### BLOCS
			tgp_setup_historical_house_bloc_effect = yes
		}
		#

		#Warcraft
		# Terenia
		character:60677 ?= {
			add_character_flag = { flag = no_hat years = 15 }
			if = {
				limit = { age < 16 age >= 6 }
				trigger_event = { id = personal_adventure.002 days = { 20 40 } }
			}
			else_if = {
				limit = { age < 6 }
				trigger_event = { id = personal_adventure.002 months = { 29 30 } }
			}
			if = {
				limit = { is_ruler = yes age < 16 }
				father = { set_employer = prev }
				try_start_diarchy = regency
				designate_diarch = father
				set_diarch = father
			}
		}
		
		if = {
			limit = { game_start_date = 603.1.1 }
			character:60004 = {
				trigger_event = { id = personal_adventure.001 days = { 2 4 } }
			}
		}
		
		### GAME RULE: Alternate Universe & Shattered Realms
		if = {
			limit = { 
				OR = { 
					has_game_rule = random_ruler_placement_on
					NOT = { has_game_rule = wc_lore_realms }
				}
			}
			if = { 
				limit = { NOT = { has_game_rule = wc_lore_realms } }
				game_rule_shattered_realms_effect = yes
			}
			if = { 
				limit = { has_game_rule = random_ruler_placement_on }
				game_rule_random_ruler_placement_effect = yes
				if = { limit = { NOT = { has_game_rule = wc_lore_realms } } 
					game_rule_random_ruler_placement_liege_leniency_effect = yes
				}
			}
		}

		# Warcraft
		every_county = {
			save_scope_as = county
			holder = {
				save_scope_as = councillor_liege
			}

			corrupt_county_effect = { ON_START = yes }
		}
	}
}

# Like on_game_start, except it is called once the host (or player, in single player) exits the lobby. Good for anything where you need to know who the players are, or what the game rules are
on_game_start_after_lobby = {
	effect = {
		## Story Triggers
		character:450003 = {
			trigger_event = {
				id = princess.0001
				years = 9
			}
		}
		character:600043 = {
			trigger_event = {
				id = arthas.001
				years = 12
			} 
		}
		character:60572 = {
			trigger_event = {
				id = sally.0001
				years = 20
			}
		}
		every_living_character = {
			trigger_on_game_start_effect = yes
		}
		
		every_ruler = {
			# Make sure that Realm Priests are landed theocrats where it makes sense
			if = {
				limit = {
					highest_held_title_tier >= tier_duchy
				}
				if = {
					limit = {
						exists = cp:councillor_court_chaplain
						cp:councillor_court_chaplain = {
							is_ruler = no
						}
						faith = { has_doctrine = doctrine_clerical_succession_spiritual_fixed_appointment }
						any_vassal = {
							is_physically_able_adult = yes
							is_councillor = no
							government_has_flag = government_is_theocracy
							can_be_court_chaplain_trigger = { COURT_OWNER = liege }
							faith = liege.faith
						}
					}
					random_vassal = {
						limit = {
							is_physically_able_adult = yes
							is_councillor = no
							government_has_flag = government_is_theocracy
							can_be_court_chaplain_trigger = { COURT_OWNER = liege }
							faith = liege.faith
						}
						weight = {
							base = 1
							modifier = {
								add = 1000
								faith.religious_head ?= this
							}
							modifier = {
								add = learning
							}
							modifier = {
								add = primary_title.tier
							}
						}
						liege = {
							assign_councillor_type = {
								type = councillor_court_chaplain
								remove_existing_councillor = yes
								target = prev
							}
						}
					}
				}
				if = {
					limit = {
						is_landless_adventurer = yes
					}
					if = { limit = { has_realm_law = crown_authority_0 } remove_realm_law = crown_authority_0 }
				}
			}
			#Autopopulate families.
			if = {
				limit = {
					trigger_if = {
						limit = {
							has_game_rule = on_generate_families_ai_only
						}
						is_ai = yes
					}
					trigger_else = {
						has_game_rule = on_generate_families
					}
				}
				trigger_event = game_rule.1001
			}

			### CE1 LEGITIMACY SETUP ###
			if = {
				limit = {
					exists = this
					has_legitimacy = yes
				}
				add_legitimacy = base_legitimacy_value
			}

			### MANDALA SETUP ###
			if = {
				limit = { government_has_flag = government_is_mandala }

				#Triple Mandala's Legitimacy to make them not start at a negative expectation at game start
				add_legitimacy = {
					value = legitimacy
					multiply = 2
					if = {
						limit = {
							highest_held_title_tier > tier_duchy
						}
						multiply = 3
					}
					else = { multiply = 2 }
				}

				#Yer starter kit
				change_to_mandala_government_decree_effect = yes
				#No Succession for this character pls
				set_variable = {
					name = not_subject_to_succession_trials
					value = flag:started_as_mandala
				}
				if = {
					limit = { var:not_subject_to_succession_trials ?= flag:started_as_mandala }
					#To prevent 'unused except in loc' errors :catto:
				}

				#Aspect modifiers?
				house = {
					#Start counting years of peace
					if = {
						limit = { has_house_head_parameter = peaceful_rule_5_year_modifier }
						house_head = {
							#Aspect modifier
							set_variable = {
								name = mandala_house_power_accumulated_increments_of_peace
								value = 1
							}
							add_character_modifier = { modifier = mandala_increments_of_peace_modifier }
							trigger_event = {
								id = tgp_east_asia_mandala_events.0200
								years = 5
							}
							#Aspect trigger
							set_variable = {
								name = serenity_mandala_years_of_non_aggression_war
								value = 0
							}
							trigger_event = {
								id = tgp_east_asia_mandala_events.0205
								years = 1
							}
						}
					}
					#Give the initial Creator modifier
			    	if = {
						limit = { has_house_head_parameter = creator_10_year_modifier }
						house_head = {
							set_variable = {
								name = mandala_house_power_accumulated_creator
								value = 1
								years = 10
							}
							hidden_effect = {
								mandala_apply_10_year_modifier = yes
							}
						}
					}
				}
			}

			if = {
				limit = {
					title:h_pandaria.holder ?= top_liege #Warcraft
					this != top_liege
				}
				### TGP MERIT AND TREASURY HANDOUT ON GAME START ###
				if = {
					limit = {
						culture = {
							like_heritage_chinese_trigger = yes
						}
						NOR = {
							AND = {
								has_council_position = councillor_court_chaplain
								NOT = { has_title = title:e_minister_of_rites }
							}
							has_trait = devoted
						}
						government_has_flag = government_is_celestial
						is_faith_dominant_gender = yes
					}
					save_temporary_scope_as = exam_contender
					hidden_effect = {
						assign_completed_exams_based_on_merit_effect = yes
					}
					if = {
						limit = {
							any_parent = {
								OR = {
									has_trait = ambitious
									has_trait = scholar
									has_trait = diligent
									has_trait = confucian_education
								}
							}
							NOR = {
								has_trait = lazy
								has_trait = dull
								has_trait = intellect_bad
								location.county ?= {
									development_level <= bad_development_level
								}
							}
						}
						add_character_flag = passed_child_exam
					}
					if = { # We adjust Merit depending on the dynastic cycle phase
						limit = {
							situation:dynastic_cycle ?= {
								situation_current_phase = situation_dynastic_cycle_phase_stability_advancement
							}
						}
						change_merit = {
							value = merit
							multiply = 0.1
						}
					}
					if = {
						limit = {
							is_ai = no
							is_governor_or_admin_count = yes
						}
						spawn_celestial_governance_contract_effect = yes
					}
					# Warcraft
					# if = {
					# 	limit = {
					# 		game_start_date = 867.1.1
					# 	}
					# 	title:k_hebei.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_youji.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_daibei.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_guannei.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_viet.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_lingxi.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# }
					# else_if = {
					# 	limit = {
					# 		game_start_date = 1066.9.15
					# 	}
					# 	title:k_hebei.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_hedong.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_guannei.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_lingxi.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# }
					# else_if = {
					# 	limit = {
					# 		game_start_date = 1178.10.1
					# 	}
					# 	title:k_huainan.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_shannan.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_xingyuan.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_lingxi.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# 	title:k_xichuan.holder = {
					# 		hidden_effect = {
					# 			vassal_contract_set_obligation_level = {
					# 				type = celestial_provinces
					# 				level = 3 # Military
					# 			}
					# 			if = {
					# 				limit = {
					# 					NOT = {
					# 						has_realm_law = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 				add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 			}
					# 		}
					# 		every_vassal = {
					# 			limit = {
					# 				primary_title.tier >= tier_county
					# 			}
					# 			hidden_effect = {
					# 				vassal_contract_set_obligation_level = {
					# 					type = celestial_provinces
					# 					level = 3 # Military
					# 				}
					# 				if = {
					# 					limit = {
					# 						NOT = {
					# 							has_realm_law = celestial_military_appointment_succession_law
					# 						}
					# 					}
					# 					add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 				}
					# 			}
					# 			every_vassal = {
					# 				limit = {
					# 					primary_title.tier >= tier_county
					# 				}
					# 				hidden_effect = {
					# 					vassal_contract_set_obligation_level = {
					# 						type = celestial_provinces
					# 						level = 3 # Military
					# 					}
					# 					if = {
					# 						limit = {
					# 							NOT = {
					# 								has_realm_law = celestial_military_appointment_succession_law
					# 							}
					# 						}
					# 						add_realm_law_skip_effects = celestial_military_appointment_succession_law
					# 					}
					# 				}
					# 			}
					# 		}
					# 	}
					# }
				
				}
				### Examination pass status and initial wave of governor candidates done after game start, in order to include generated families ###
				every_courtier = {
					limit = {
						is_lowborn = no
						culture = { like_heritage_chinese_trigger = yes } #Warcraft
						NOR = {
							has_council_position = councillor_court_chaplain
							has_trait = devoted
						}
						government_has_flag = government_is_celestial # courtiers have governments, too!
						is_faith_dominant_gender = yes
						age >= 30
						static_group_filter = {
							group = ai_filter
							match = 0.5
						}
					}
					hidden_effect = {
						add_character_flag = passed_provincial_exam
						add_character_modifier = {
							modifier = tgp_passed_provincial_exam_modifier
						}
						add_character_flag = passed_metropolitan_exam
						add_character_modifier = {
							modifier = tgp_passed_metropolitan_exam_modifier
						}
						change_merit = {
							value = county_starting_merit_value
							add = age
							add = learning
						}
					}
				}
				save_scope_as = governor
			}

			if = {
				limit = {
					government_has_flag = government_has_merit
					title:h_pandaria.holder != top_liege
				}
				### TGP MERITOCRATIC/STEPPE ADMIN SETUP ON GAME START ###
				if = {
					limit = {
						NOR = {
							AND = {
								has_council_position = councillor_court_chaplain
								NOT = { has_title = title:e_minister_of_rites }
							}
							has_trait = devoted
						}
						government_has_flag = government_has_merit
						is_faith_dominant_gender = yes
					}
					hidden_effect = {
						meritocratic_assign_completed_exams_based_on_merit_effect = yes
					}
				}
			}

			#elder/disciple setup
			if = {
				limit = {
					government_allows = merit
					top_overlord != title:h_pandaria.holder
				}
				if = {
					limit = {
						top_liege = this
						merit_level >= merit_level_expected_kingdom_value
					}
					add_to_list = elders
				}
				else_if = {
					limit = {
						merit_level >= merit_level_expected_duchy_value
					}
					add_to_list = elders
				}
				else = {
					add_to_list = disciple
				}
			}

			# Sexualities if game rules are default
			if = {
				limit = { has_game_rule = sexuality_distribution_default }
				if = {
					limit = {
						is_adult = no
						age >= 10
					}
					game_rule_sexuality_distribution_reroll_effect = yes
				}

				every_courtier_or_guest = {
					if = {
						limit = {
							is_adult = no
							age >= 10
						}
						game_rule_sexuality_distribution_reroll_effect = yes
					}
				}
			}
		}

		if = {
			limit = { has_game_rule = sexuality_distribution_default }
			every_duchy = {
				limit = {
					exists = title_capital_county.title_province
				}
				title_capital_county.title_province = { save_scope_as = pool_province }
				# Sexualities for Pool Characters if game rules are default
				every_pool_character = {
					limit = {
						NOT = { is_in_list = pool_characters }
					}
					province = scope:pool_province
					add_to_list = pool_characters
				}
			}
			every_in_list = {
				list = pool_characters
				if = {
					limit = {
						is_adult = no
						age >= 10
					}
					game_rule_sexuality_distribution_reroll_effect = yes
				}
			}
		}

		#elder/disciple setup (continued from above)
		every_in_list = {
			list = disciple
			save_scope_as = disciple
			random_in_list = {
				list = elders
				limit = {
					top_liege = scope:disciple.top_liege
					eligible_for_elder_trigger = {
						DISCIPLE = scope:disciple
					}
				}
				save_scope_as = elder
			}
			if = {
				limit = {
					exists = scope:elder
				}
				random = {
					chance = 65
					set_relation_elder = scope:elder
				}
			}
		}

		# if = {
		# 	limit = {
		# 		has_mpo_dlc_trigger = yes
		# 	}
		# 	#Fully Landlocked Nomad Cultures Setup
		# 	every_culture_global = {
		# 		limit = {
		# 			OR = {
		# 				has_cultural_pillar = heritage_mongolic
		# 				has_cultural_pillar = heritage_ugro_permian
		# 			}
		# 		}
		# 		add_to_global_variable_list = {
		# 			name = fully_landlocked_nomad_cultures
		# 			target = this
		# 		}
		# 	}
		# 	add_to_global_variable_list = {
		# 		name = fully_landlocked_nomad_cultures
		# 		target = culture:kipchak
		# 	}
		# 	add_to_global_variable_list = {
		# 		name = fully_landlocked_nomad_cultures
		# 		target = culture:uyghur
		# 	}
		# 	add_to_global_variable_list = {
		# 		name = fully_landlocked_nomad_cultures
		# 		target = culture:kirghiz
		# 	}
		# 	add_to_global_variable_list = {
		# 		name = fully_landlocked_nomad_cultures
		# 		target = culture:tangut
		# 	}
		# 	add_to_global_variable_list = {
		# 		name = fully_landlocked_nomad_cultures
		# 		target = culture:bashkir
		# 	}
		# 	add_to_global_variable_list = {
		# 		name = fully_landlocked_nomad_cultures
		# 		target = culture:laktan
		# 	}
		# 	recalculate_cultural_heads_of_type = herd
		# }

		### GAME RULE: VIEW ON SAME-SEX RELATIONS
		if = {
			limit = { has_game_rule = accepted_same_sex_relations }
			game_rule_accepted_same_sex_relations_effect = yes
		}

		### GAME RULE: RANDOM RULER PLACEMENT
		if = {
			limit = { NOT = { has_game_rule = random_ruler_placement_off } }
			game_rule_random_ruler_placement_effect = yes
			union_members_on_game_start_alternate_universe_effect = yes
		}
		else = {
			union_members_on_game_start_effect = yes
		}

		### GAME RULE: RANDOMIZE FAITH
		if = {
			limit = { has_game_rule = randomized_faiths_on }
			game_rule_randomize_faith_effect = yes
		}

		### GAME RULE: FAITH ACCEPTANCE
		if = {
			limit = { has_game_rule = full_faith_acceptance }
			game_rule_faith_acceptance_effect = yes
		}

		### GAME RULE: GENDER EQUALITY ###
		if = {
			limit = { has_game_rule = full_gender_equality }
			game_rule_full_gender_equality_effect = yes
		}
		else_if = {
			limit = { has_game_rule = inversed_gender_equality }
			game_rule_inversed_gender_equality_effect = yes
		}
		else_if = {
			limit = { has_game_rule = lenient_gender_equality }
			game_rule_lenient_gender_equality_effect = yes
		}

		### GAME RULE: SEXUALITY DISTRIBUTION ###
		if = {
			limit = { NOT = { has_game_rule = sexuality_distribution_default } }
			game_rule_sexuality_distribution_effect = yes
		}
		else = { # So that children 10+ starts with a sexuality
			child_sexuality_distribution_effect = yes
		}
		### GAME RULE: EXTRA ADMINS
		## We'll be doing some excessive triggers below in a bid to lightly future-proof + error-spam mods less, don't worry about it.
		### We handle players after the lobby.
		# Historic chars.
		apply_historic_administrative_game_rule_effect = yes
		# Players.
		if = {
			limit = { has_dlc_feature = roads_to_power }
			if = {
				limit = {
					NOT = { has_game_rule = historicity_extra_admin_player_wherever_gameplay_not_administrative }
				}
				if = {
					limit = { has_game_rule = historicity_extra_admin_player_wherever_alt_historic_always }
					every_player = {
						limit = {
							highest_held_title_tier >= tier_kingdom
							NOR = {
								government_allows = administrative
								is_landed = no
							}
						}
						convert_to_administrative_from_feudalism_game_start_effect = yes
					}
				}
				else_if = {
					limit = { has_game_rule = historicity_extra_admin_player_wherever_alt_historic_with_august_trait }
					every_player = {
						limit = {
							highest_held_title_tier >= tier_kingdom
							NOR = {
								government_allows = administrative
								is_landed = no
							}
							has_trait = august
						}
						convert_to_administrative_from_feudalism_game_start_effect = yes
					}
				}
			}
		}

		# Give Ruler Designer characters regencies.
		every_in_global_list = {
			variable = rd_chars_needing_regencies
			trigger_event = diarchy.0011
			# Aaaand clean the list.
			save_temporary_scope_as = char_temp
			remove_list_global_variable = {
				name = rd_chars_needing_regencies
				target = scope:char_temp
			}
		}

		### ACHIEVEMENT: FROM RAGS TO RICHES
		every_player = {
			limit = { highest_held_title_tier = tier_county }
			add_achievement_global_variable_effect = {
				VARIABLE = achievement_rags_to_riches_valid
				VALUE = yes
			}
		}

		### ACHIEVEMENT (FP2): Holidaying in Iberia
		#every_player = { #Warcraft
		#	limit = { fp2_character_involved_in_struggle_trigger = no }
		#	add_achievement_global_variable_effect = {
		#		VARIABLE = fp2_holiday_in_iberia_achievement_unlocked
		#		VALUE = no # Boolean in actual usage
		#	}
		#}

		### ACHIEVEMENT TRACKING FOR STARTING CHARACTERS
		if = {
			limit = { has_multiple_players = no }
			every_player = {
				# TGP
				#if = {
				#	limit = {
				#		government_has_flag = government_is_wanua
				#	}
				#	add_achievement_global_variable_effect = {
				#		VARIABLE = started_ep4_15_humble_beginnings_achievement
				#		VALUE = yes
				#	}
				#}
				#if = {
				#	limit = {
				#		has_title = title:k_chrysanthemum_throne
				#	}
				#	add_achievement_global_variable_effect = {
				#		VARIABLE = started_ep4_03_sword_of_japan_achievement
				#		VALUE = yes
				#	}
				#}
				#if = {
				#	limit = {
				#		is_landed = no
				#		tgp_is_any_minister = no
				#	}
				#	add_achievement_global_variable_effect = {
				#		VARIABLE = started_ep4_05_grand_governor_achievement
				#		VALUE = yes
				#	}
				#}
				#if = {
				#	limit = {
				#		NAND = {
				#			tgp_passed_children_examination = yes
				#			tgp_passed_provincial_examination = yes
				#			tgp_passed_metropolitan_examination = yes
				#			tgp_passed_palace_examination = yes
				#		}
				#	}
				#	add_achievement_global_variable_effect = {
				#		VARIABLE = started_ep4_16_flying_colors_achievement
				#		VALUE = yes
				#	}
				#}
				#if = {
				#	limit = {
				#		NOT = {
				#			culture = {
				#				any_known_innovation = {
				#					has_innovation_parameter = silk_road_innovation_parameter
				#				}
				#			}
				#		}
				#	}
				#	add_achievement_global_variable_effect = {
				#		VARIABLE = started_ep4_17_highway_of_ideas_achievement
				#		VALUE = yes
				#	}
				#}
				#if = {
				#	limit = {
				#		NOR = {
				#			tgp_passed_children_examination = yes
				#			tgp_passed_provincial_examination = yes
				#			tgp_passed_metropolitan_examination = yes
				#			tgp_passed_palace_examination = yes
				#		}
				#	}
				#	add_achievement_global_variable_effect = {
				#		VARIABLE = started_ep4_19_stamp_of_approval_achievement
				#		VALUE = yes
				#	}
				#}
				# Base Title
				# if = {
				# 	limit = {
				# 		exists = character:7757
				# 		this = character:7757
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_give_a_dog_a_bone_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		exists = character:1128
				# 		this = character:1128
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_wily_as_the_fox_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		OR = {
				# 			AND = {
				# 				exists = character:108501
				# 				this = character:108501
				# 			}
				# 			AND = {
				# 				exists = character:107500
				# 				this = character:107500
				# 			}
				# 			AND = {
				# 				exists = character:107501
				# 				this = character:107501
				# 			}
				# 			AND = {
				# 				exists = character:108500
				# 				this = character:108500
				# 			}
				# 			AND = {
				# 				exists = character:109500
				# 				this = character:109500
				# 			}
				# 		}
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_sibling_rivalry_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		OR = {
				# 			AND = {
				# 				exists = character:163108
				# 				this = character:163108
				# 			}
				# 			AND = {
				# 				exists = character:163110
				# 				this = character:163110
				# 			}
				# 			AND = {
				# 				exists = character:163111
				# 				this = character:163111
				# 			}
				# 			AND = {
				# 				exists = character:163112
				# 				this = character:163112
				# 			}
				# 			AND = {
				# 				exists = character:163119
				# 				this = character:163119
				# 			}
				# 		}
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_blood_eagle_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		exists = character:6448
				# 		this = character:6448
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_kings_to_the_seventh_generation_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		exists = character:140
				# 		this = character:140
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_norman_yoke_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		exists = character:522
				# 		this = character:522
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_royal_dignity_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		exists = character:40605
				# 		this = character:40605
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_land_of_the_rus_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		exists = character:251187
				# 		this = character:251187
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_mother_of_us_all_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		OR = {
				# 			culture = { has_cultural_pillar = heritage_iberian }
				# 			culture = culture:andalusian
				# 		}
				# 		has_religion = religion:christianity_religion
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_reconquista_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		culture = culture:irish
				# 		capital_province = { geographical_region = custom_kaldorei_empire }
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_the_emerald_isle_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		OR = {
				# 			culture = culture:castilian
				# 			culture = culture:basque
				# 			culture = culture:portuguese
				# 			culture = culture:catalan
				# 			culture = culture:andalusian
				# 			culture = culture:visigothic
				# 			culture = culture:suebi
				# 		}
				# 		has_religion = religion:islam_religion
				# 		capital_province = { geographical_region = world_europe_west_iberia }
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_al_andalus_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		exists = character:159137
				# 		this = character:159137
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_almost_there_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		exists = character:109607
				# 		this = character:109607
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_last_count_first_king_achievement
				# 		VALUE = yes
				# 	}
				# }
				# if = {
				# 	limit = {
				# 		exists = character:6878
				# 		this = character:6878
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_going_places_achievement
				# 		VALUE = yes
				# 	}
				# }
				# FP1
				## far_from_home_achievement
				# if = {
				# 	limit = {
				# 		# Starting as a Norse pagan Norse-cultured character.
				# 		fp1_achievement_culture_plus_religion_norse_trigger = yes
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_far_from_home_achievement
				# 		VALUE = yes
				# 	}
				# }
				# ## miklagardariki_achievement
				# if = {
				# 	limit = {
				# 		# Starting as a Norse pagan Norse-cultured character.
				# 		fp1_achievement_culture_plus_religion_norse_trigger = yes
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_miklagardariki_achievement
				# 		VALUE = yes
				# 	}
				# }
				## canute_the_greater_achievement
				# add_achievement_global_variable_effect = {
				# 	VARIABLE = started_canute_the_greater_achievement
				# 	VALUE = yes
				# }
				## king_of_all_the_isles_achievement
				# if = {
				# 	limit = {
				# 		# Starting as a Norse pagan Norse-cultured character.
				# 		fp1_achievement_culture_plus_religion_norse_trigger = yes
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_king_of_all_the_isles_achievement
				# 		VALUE = yes
				# 	}
				# }
				## faster_than_the_fox_achievement
				# if = {
				# 	limit = {
				# 		# Starting as a Norse pagan Norse-cultured character.
				# 		fp1_achievement_culture_plus_religion_norse_trigger = yes
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_faster_than_the_fox_achievement
				# 		VALUE = yes
				# 	}
				# }
				## volva_achievement
				# if = {
				# 	limit = {
				# 		# Starting as a Norse pagan Norse-cultured character.
				# 		fp1_achievement_culture_plus_religion_norse_trigger = yes
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_volva_achievement
				# 		VALUE = yes
				# 	}
				# }
				## saga_in_stone_achievement
				add_achievement_global_variable_effect = {
					VARIABLE = started_saga_in_stone_achievement
					VALUE = yes
				}
				## first_of_the_crusader_kings_achievement
				# if = {
				# 	limit = {
				# 		# Starting as a Norse-cultured character.
				# 		fp1_achievement_culture_norse_trigger = yes
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_first_of_the_crusader_kings_achievement
				# 		VALUE = yes
				# 	}
				# }
				# ## vladimirs_second_choice_achievement
				# if = {
				# 	limit = {
				# 		# Starting as a Norse pagan Norse or Rus-cultured character.
				# 		fp1_achievement_culture_norse_or_rus_trigger = yes
				# 		fp1_achievement_religious_norse_trigger = yes
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_vladimirs_second_choice_achievement
				# 		VALUE = yes
				# 	}
				# }
				## a_dangerous_business_achievement
				# add_achievement_global_variable_effect = {
				# 	VARIABLE = started_a_dangerous_business_achievement
				# 	VALUE = yes
				# }
				# EP1
				##1 Patronage
				add_achievement_global_variable_effect = {
					VARIABLE = started_patronage_achievement
					VALUE = yes
				}
				##2 Converging Paths
				add_achievement_global_variable_effect = {
					VARIABLE = started_converging_paths_achievement
					VALUE = yes
				}
				##3 Changing course
				add_achievement_global_variable_effect = {
					VARIABLE = started_changing_course_achievement
					VALUE = yes
				}
				##4 Hoarder
				add_achievement_global_variable_effect = {
					VARIABLE = started_hoarder_achievement
					VALUE = yes
				}
				##5 creme de la creme
				add_achievement_global_variable_effect = {
					VARIABLE = started_creme_de_la_creme_achievement
					VALUE = yes
				}
				##6 Give it back!
				add_achievement_global_variable_effect = {
					VARIABLE = started_polyglot_achievement
					VALUE = yes
				}
				##7 Inspirational
				add_achievement_global_variable_effect = {
					VARIABLE = started_inspirational_achievement
					VALUE = yes
				}
				##8 One of a Kind
				add_achievement_global_variable_effect = {
					VARIABLE = started_one_of_a_kind_achievement
						VALUE = yes
				}
				##9 True Tolerance
				add_achievement_global_variable_effect = {
					VARIABLE = started_true_tolerance_achievement
					VALUE = yes
				}
				##10 Delusions of Grandeur
				add_achievement_global_variable_effect = {
					VARIABLE = started_delusions_of_grandeur_achievement_achievement
					VALUE = yes
				}
				##11 Bod Chen Po
				# if = {
				# 	limit = {
				# 		this.dynasty = dynasty:105800
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_bod_chen_po_achievement
				# 		VALUE = yes
				# 	}
				# }
				# ##12 Turkish Eagle
				# if = {
				# 	limit = {
				# 		NOT = { this = character:3040 } # Not Alp Arslan
				# 		house = house:house_seljuk # Seljuk
				# 		game_start_date < 1067.1.1 # 1066 only, and no Seljuks in 867
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_turkish_eagle_achievement
				# 		VALUE = yes
				# 	}
				# }
				##13 Rise of the Ghurids
				# if = {
				# 	limit = {
				# 		has_title = title:d_ghur
				# 		this.dynasty = dynasty:791 #Ghurid
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_rise_of_the_ghurids_achievement
				# 		VALUE = yes
				# 	}
				# }
				# ##14 Brave and Bold
				# if = {
				# 	limit = {
				# 		game_start_date < 868.1.1
				# 		this.dynasty = dynasty:699 #Piast
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_brave_and_bold_achievement
				# 		VALUE = yes
				# 	}
				# }
				##15 Lingua Franca
				add_achievement_global_variable_effect = {
					VARIABLE = started_lingua_franca_achievement
					VALUE = yes
				}
				##16 Beta Israel
				# add_achievement_global_variable_effect = {
				# 	VARIABLE = started_beta_israel_achievement
				# 	VALUE = yes
				# }
				## 17 They belong in a museum!
				add_achievement_global_variable_effect = {
					VARIABLE = started_they_belong_in_a_museum_achievement
					VALUE = yes
				}
				##18 I made this!
				add_achievement_global_variable_effect = {
					VARIABLE = started_i_made_this_achievement
					VALUE = yes
				}
				##19 Nobody Comes to Fika!
				# add_achievement_global_variable_effect = {
				# 	VARIABLE = started_nobody_comes_to_fika_achievement
				# 	VALUE = yes
				# }
				## 20 The True Royal Court
				add_achievement_global_variable_effect = {
					VARIABLE = started_the_true_royal_court_achievement
						VALUE = yes
				}
				# EP2
				## 01. The Grandest Tour
				add_achievement_global_variable_effect = {
					VARIABLE = started_the_grandest_tour_achievement
					VALUE = yes
				}
				## 02. Your Eternal Reward
				add_achievement_global_variable_effect = {
					VARIABLE = started_your_eternal_reward_achievement
					VALUE = yes
				}
				## 03. Imperial March
				add_achievement_global_variable_effect = {
					VARIABLE = started_imperial_march_achievement
					VALUE = yes
				}
				## 04. Black Dinner
				add_achievement_global_variable_effect = {
					VARIABLE = started_black_dinner_achievement
					VALUE = yes
				}
				## 05. There and Back Again
				add_achievement_global_variable_effect = {
					VARIABLE = started_there_and_back_again_achievement
					VALUE = yes
				}
				## 06. The Very Best
				add_achievement_global_variable_effect = {
					VARIABLE = started_the_very_best_achievement
					VALUE = yes
				}
				## 07. Like No One Ever Was
				add_achievement_global_variable_effect = {
					VARIABLE = started_like_no_one_ever_was_achievement
					VALUE = yes
				}
				## 08. A Thousand and One Night
				add_achievement_global_variable_effect = {
					VARIABLE = started_a_thousand_and_one_nights_achievement
					VALUE = yes
				}
				## 09. A Knight's Tale
				add_achievement_global_variable_effect = {
					VARIABLE = started_a_knights_tale_achievement
					VALUE = yes
				}
				## 10. Hunting Accident
				add_achievement_global_variable_effect = {
					VARIABLE = started_hunting_accident_achievement
					VALUE = yes
				}
				## 11. Lions and Tigers and Bears, Oh My!
				add_achievement_global_variable_effect = {
					VARIABLE = started_lions_and_tigers_and_bears_oh_my_achievement
					VALUE = yes
				}
				## 12. Fly, my Pretty!
				add_achievement_global_variable_effect = {
					VARIABLE = started_fly_my_pretty_achievement
					VALUE = yes
				}
				## 13. Pathway to Heaven
				add_achievement_global_variable_effect = {
					VARIABLE = started_pathway_to_heaven_achievement
					VALUE = yes
				}
				## 14. Sir Lance-a-Lot
				add_achievement_global_variable_effect = {
					VARIABLE = started_sir_lance_a_lot_achievement
					VALUE = yes
				}
				## 15. I'm in my Element(s)
				add_achievement_global_variable_effect = {
					VARIABLE = started_im_in_my_elements_achievement
					VALUE = yes
				}
				## 16. Ahab
				add_achievement_global_variable_effect = {
					VARIABLE = started_ahab_achievement
					VALUE = yes
				}
				## 17. Little William Marshal
				add_achievement_global_variable_effect = {
					VARIABLE = started_little_william_marshal_achievement
					VALUE = 0
				}
				add_achievement_global_variable_effect = {
					VARIABLE = little_william_marshal_achievement_tally
					VALUE = 0
				}
				## 18. A True & Perfect Knight
				add_achievement_global_variable_effect = {
					VARIABLE = started_a_true_and_perfect_knight_achievement
					VALUE = yes
				}
				## 19. A.E.I.O.U & Me
				# if = {
				# 	limit = {
				# 		# Etichonen, of whom the Hapsburgs are a cadet - we check dynasty rather than house so that an accidental cadet doesn't screw you.
				# 		this.house ?= house:house_habsburg
				# 	}
				# 	add_achievement_global_variable_effect = {
				# 		VARIABLE = started_a_e_i_o_u_and_me_achievement
				# 		VALUE = yes
				# 	}
				# }
				## 20. The Iron and Golden King
				add_achievement_global_variable_effect = {
					VARIABLE = started_the_iron_and_golden_king_achievement
					VALUE = yes
				}

				### RULER DESIGNER ACHIEVEMENT BLOCKS ###
				if = {
					limit = {
						num_virtuous_traits >= 3
					}
					add_achievement_flag_effect = { FLAG = rd_character_blocked_paragon_of_virtue_achievement_flag	}
				}
				if = {
					limit = {
						any_child = {
							count >= 10
							is_alive = yes
						}
					}
					add_achievement_flag_effect = { FLAG = rd_character_blocked_the_succession_is_safe_achievement_flag }
				}
				if = {
					limit = {
						any_child = {
							has_trait = inbred
						}
					}
					add_achievement_flag_effect = { FLAG = rd_character_blocked_keeping_it_in_the_family_achievement_flag }
				}
				if = {
					limit = {
						highest_held_title_tier >= tier_empire
						should_be_naked_trigger = yes
					}
					add_achievement_flag_effect = { FLAG = rd_character_blocked_the_emperors_new_clothes_achievement_flag }
				}
				# if = {
				# 	limit = {
				# 		is_from_ruler_designer = yes
				# 		OR = {
				# 			fp1_achievement_culture_norse_trigger = yes
				# 			fp1_achievement_religious_norse_trigger = yes
				# 		}
				# 	}
				# 	#add_to_global_unavailable_achievements_list_effect = { FLAG = flag:rd_character_blocked_far_from_home_achievement }
				# 	#add_to_global_unavailable_achievements_list_effect = { FLAG = flag:rd_character_blocked_miklagardariki_achievement }
				# 	#add_to_global_unavailable_achievements_list_effect = { FLAG = flag:rd_character_blocked_faster_than_the_fox_achievement }
				# }
				if = {
					limit = {
						any_ruler = {
							is_from_ruler_designer = yes
						}
					}
					#add_to_global_unavailable_achievements_list_effect = { FLAG = flag:rd_character_blocked_iberia_or_iberia_achievement }
					#add_to_global_unavailable_achievements_list_effect = { FLAG = flag:rd_character_blocked_el_cid_achievement }
					add_achievement_global_variable_effect = {
						VARIABLE = any_ruler_designed_character_achievement
						VALUE = yes
					}
				}
				#if = { #Warcraft
				#	limit = {
				#		has_mpo_dlc_trigger = yes
				#		exists = character:125501
				#		character:125501 = {
				#			is_alive = yes
				#		}
				#	}
				#	character:125501 = {
				#		create_story = story_temujin_flavor
				#		trigger_event = {
				#			days = { 12 30 }
				#			id = mpo_temujin_flavor.0030 # Borte announces she's pregnant
				#		}
				#	}
				#}
			}
		}

		### ACHIEVEMENT (FP3): The Ummayad Strikes Back
		# every_player = {
		# 	if = {
		# 		limit = {
		# 			dynasty = character:73683.dynasty
		# 			location = { geographical_region = world_europe_west_iberia }
		# 		}
		# 		set_global_variable = fp3_the_umma_strikes_back_achievement_tracker # Is not removed (sad!)
		# 	}
		# }

		### ACHIEVEMENT: FROM RAGS TO RICHES TO RAGS TO RICHES
		every_player = {
			limit = { highest_held_title_tier = tier_county }
			add_achievement_global_variable_effect = {
				VARIABLE = achievement_rags_to_riches_to_rags_to_riches_valid
				VALUE = yes
			}
		}

		#Set starting cultural acceptance
		# Warcraft

		### CE1 LEGITIMACY SETUP ###
		every_ruler = {
			limit = {
				has_legitimacy = yes
			}
			add_legitimacy = base_legitimacy_value
		}
		### EP3 SETUP ###
		if = {
			limit = { has_ep3_dlc_trigger = yes }
			### EP3 LAAMP SETUP ###
			# Resources.
			every_independent_ruler = {
				limit = { has_government = landless_adventurer_government }
				# Cash.
				add_gold = {
					value = {
						value = 0
						add = prestige
						add = piety
						divide = 10
					}
				}
				save_temporary_scope_as = adventurer_scope
				# Set CoA
				primary_title = { set_coa = scope:adventurer_scope.house }
				# Cleanup characters
				every_councillor = {
					if = {
						limit = {
							NOR = {
								has_council_position = councillor_court_chaplain
								has_council_position = councillor_spouse
							}
						}
						scope:adventurer_scope = {
							fire_councillor = prev
						}
						remove_opinion = {
							modifier = fired_from_council_opinion
							target = scope:adventurer_scope
						}
					}
					else_if = {
						limit = {
							NOR = {
								is_close_or_extended_family_of = prev
								has_relation_lover = prev
								has_relation_friend = prev
								is_consort_of = prev
								has_council_position = councillor_spouse
							}
						}
						override_death_effect = {
							death_reason = death_vanished
						}
					}
				}
				# Evict everyone who isn't your family from your camp.
				every_courtier = {
					limit = {
						prev = { save_temporary_scope_as = char_temp }
						NOR = {
							dynasty ?= scope:char_temp.dynasty
							is_imprisoned_by = scope:char_temp
							# Plus any relations, who are presumably meant to be here.
							has_important_relationship_with_character_trigger = { CHARACTER = scope:char_temp }
							# Catch bastards and such that may be left over.
							is_close_or_extended_family_of = scope:char_temp
						}
					}
					move_to_pool = yes
				}
				# Courtiers.
				trigger_event = ep3_laamps.1001
			}
			# Starting camp purposes.
			## Danath Trollbane
			character:38004 ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
					if = {
						limit = {
							character:herrick = {
								NOT = { is_courtier_of = character:38004 }
							}
						}
						add_courtier = character:herrick
					}
				}
			}
			## Menag Bloodhill
			character:menag ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_brigands
					if = {
						limit = {
							character:benedict_bloodhill = {
								NOT = { is_courtier_of = character:menag }
							}
						}
						add_courtier = character:benedict_bloodhill
					}
				}
			}
			## Boss Tho'grun
			character:boss_thogrun ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
				}
			}
			## Anthion Harmon
			character:anthion_harmon ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
					if = {
						limit = {
							character:ysida_harmon = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:ysida_harmon
					}
					if = {
						limit = {
							character:mokvar = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:mokvar
					}
					if = {
						limit = {
							character:bodley = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:bodley
					}
					if = {
						limit = {
							character:theldren = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:theldren
					}
					if = {
						limit = {
							character:deliana = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:deliana
					}
					if = {
						limit = {
							character:mor_grayhoof = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:mor_grayhoof
					}
					if = {
						limit = {
							character:isalien = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:isalien
					}
					if = {
						limit = {
							character:jarien = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:jarien
					}
					if = {
						limit = {
							character:sothos = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:sothos
					}
					if = {
						limit = {
							character:kormok = {
								NOT = { is_courtier_of = character:anthion_harmon }
							}
						}
						add_courtier = character:kormok
					}
				}
			}
			## Malus
			character:silverlaine_thorne ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
					if = {
						limit = {
							character:zathra = {
								NOT = { is_courtier_of = character:silverlaine_thorne }
							}
						}
						add_courtier = character:zathra
					}
					if = {
						limit = {
							character:reigol_valdread = {
								NOT = { is_courtier_of = character:silverlaine_thorne }
							}
						}
						add_courtier = character:reigol_valdread
					}
				}
			}
			## Brann Bronzebeard
			character:17028 ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_explorers
					if = {
						limit = {
							character:samul_strangehands = {
								NOT = { is_courtier_of = character:17028 }
							}
						}
						add_courtier = character:samul_strangehands
					}
				}
			}
			## Tae'thelan Bloodwatcher
			character:taethelan_bloodwatcher ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_explorers
					if = {
						limit = {
							character:arlethal_sunwatcher = {
								NOT = { is_courtier_of = character:taethelan_bloodwatcher }
							}
						}
						add_courtier = character:arlethal_sunwatcher
					}
				}
			}
			## Collector Kojo
			character:collector_kojo ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_scholars
					if = {
						limit = {
							character:scrollsage_nola = {
								NOT = { is_courtier_of = character:collector_kojo }
							}
						}
						add_courtier = character:scrollsage_nola
					}
					if = {
						limit = {
							character:kajosh_tortollan = {
								NOT = { is_courtier_of = character:collector_kojo }
							}
						}
						add_courtier = character:kajosh_tortollan
					}
					if = {
						limit = {
							character:tiang_tortollan = {
								NOT = { is_courtier_of = character:collector_kojo }
							}
						}
						add_courtier = character:tiang_tortollan
					}
				}
			}
			## Lorewalker Cho
			character:lorewalker_cho ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_scholars
				}
			}
			## Harkyn Grymstone
			character:harkyn_grymstone ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
					if = {
						limit = {
							character:groth = {
								NOT = { is_courtier_of = character:harkyn_grymstone }
							}
						}
						add_courtier = character:groth
					}
					if = {
						limit = {
							character:voll = {
								NOT = { is_courtier_of = character:harkyn_grymstone }
							}
						}
						add_courtier = character:voll
					}
					if = {
						limit = {
							character:snee = {
								NOT = { is_courtier_of = character:harkyn_grymstone }
							}
						}
						add_courtier = character:snee
					}
				}
			}
			## Seer Ixit
			character:seer_ixit ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_legitimists
					if = {
						limit = {
							character:kilix_the_unraveler = {
								NOT = { is_courtier_of = character:seer_ixit }
							}
						}
						add_courtier = character:kilix_the_unraveler
					}
					if = {
						limit = {
							character:reclaimer_azak = {
								NOT = { is_courtier_of = character:seer_ixit }
							}
						}
						add_courtier = character:reclaimer_azak
					}
				}
			}
			## Zabra Hexx
			character:zabra_hexx ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_scholars
				}
			}
			## Flynn Fairwind
			character:flynn_fairwind ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
				}
			}
			## Millhouse Manastorm
			character:millhouse_manastorm ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_scholars
				}
			}
			## Captain Rhenik
			character:captain_rhenik ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_brigands
					if = {
						limit = {
							character:owings = {
								NOT = { is_courtier_of = character:captain_rhenik }
							}
						}
						add_courtier = character:owings
					}
					if = {
						limit = {
							character:first_mate_malone = {
								NOT = { is_courtier_of = character:captain_rhenik }
							}
						}
						add_courtier = character:first_mate_malone
					}
					if = {
						limit = {
							character:boatswain_taryn = {
								NOT = { is_courtier_of = character:captain_rhenik }
							}
						}
						add_courtier = character:boatswain_taryn
					}
					if = {
						limit = {
							character:boatswain_mace = {
								NOT = { is_courtier_of = character:captain_rhenik }
							}
						}
						add_courtier = character:boatswain_mace
					}
					if = {
						limit = {
							character:navigator_swink = {
								NOT = { is_courtier_of = character:captain_rhenik }
							}
						}
						add_courtier = character:navigator_swink
					}
					if = {
						limit = {
							character:quartermaster_killian = {
								NOT = { is_courtier_of = character:captain_rhenik }
							}
						}
						add_courtier = character:quartermaster_killian
					}
				}
			}
			## Rhan'ka
			character:rhanka ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_brigands
					if = {
						limit = {
							character:grenja = {
								is_alive = yes
								NOT = { is_courtier_of = character:rhanka }
							}
						}
						add_courtier = character:grenja
					}
					if = {
						limit = {
							character:manzul = {
								is_alive = yes
								NOT = { is_courtier_of = character:rhanka }
							}
						}
						add_courtier = character:manzul
					}
					if = {
						limit = {
							character:volni = {
								is_alive = yes
								NOT = { is_courtier_of = character:rhanka }
							}
						}
						add_courtier = character:volni
					}
					if = {
						limit = {
							character:zulsan = {
								is_alive = yes
								NOT = { is_courtier_of = character:rhanka }
							}
						}
						add_courtier = character:zulsan
					}
				}
			}
			## Ana Bloodteeth
			character:ana_bloodteeth ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_brigands
				}
			}
			## Sigismund Blackthorn
			character:60675 ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_brigands
				}
			}
			## Harrison Jones
			character:harrison_jones ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_explorers
				}
			}
			## Samuro of the Blade
			character:samuro_blademaster ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
				}
			}
			## Williden Marshal
			character:williden_marshal ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_explorers
					if = {
						limit = {
							character:holanyee_marshal = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:holanyee_marshal
					}
					if = {
						limit = {
							character:jd_collie = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:jd_collie
					}
					if = {
						limit = {
							character:larion = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:larion
					}
					if = {
						limit = {
							character:muigin = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:muigin
					}
					if = {
						limit = {
							character:nergal = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:nergal
					}
					if = {
						limit = {
							character:karna_remtravel = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:karna_remtravel
					}
					if = {
						limit = {
							character:petra_grossen = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:petra_grossen
					}
					if = {
						limit = {
							character:gibbert = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:gibbert
					}
					if = {
						limit = {
							character:gryfe = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:gryfe
					}
					if = {
						limit = {
							character:quixxil = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:quixxil
					}
					if = {
						limit = {
							character:spraggle_frock = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:spraggle_frock
					}
					if = {
						limit = {
							character:krakle = {
								is_alive = yes
								NOT = { is_courtier_of = character:williden_marshal }
							}
						}
						add_courtier = character:krakle
					}
				}
			}
			
			#Patreon laamps
			## Markus Wilder - patreon
			character:310280 ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
				}
			}
			## Nicholas - patreon
			character:patron310686 ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
				}
			}
			## Akasta - patreon
			character:patron310689 ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_explorers
				}
			}
			## Murlocus - patreon
			character:patron310693 ?= {
				if = {
					limit = {
						is_alive = yes
						has_government = landless_adventurer_government
					}
					add_realm_law_skip_effects = camp_purpose_mercenaries
				}
			}
			every_independent_ruler = {
				if = {
					limit = { is_landless_adventurer = yes }
					# C... food.
					domicile = { change_provisions = starting_provisions_value }
					# Contracts
					if = {
						limit = { is_ai = no }
						# Set up additional firing contracts.
						player_adventurer_contract_generation_on_wait_in_place_effect = yes
						#generate contracts if you are far away from your previous location
						player_adventurer_contract_generation_on_domicile_moved_effect = yes
					}
					else = {
						create_story = { type = story_adventurer_ai }
						trigger_event = {
							on_action = on_adventurer_ai_new_employer_arrival
							days = { 10 30 }
						}
					}
					# Sort our starting flavourisation.
					if = {
						limit = { has_realm_law = camp_purpose_mercenaries }
						set_variable = flavourise_camp_purpose_mercenaries
					}
					else_if = {
						limit = { has_realm_law = camp_purpose_wanderers }
						set_variable = flavourise_camp_purpose_wanderers
					}
					else_if = {
						limit = { has_realm_law = camp_purpose_scholars }
						set_variable = flavourise_camp_purpose_scholars
					}
					else_if = {
						limit = { has_realm_law = camp_purpose_explorers }
						set_variable = flavourise_camp_purpose_explorers
					}
					else_if = {
						limit = { has_realm_law = camp_purpose_brigands }
						set_variable = flavourise_camp_purpose_brigands
					}
					else_if = {
						limit = { has_realm_law = camp_purpose_legitimists }
						set_variable = flavourise_camp_purpose_legitimists
					}
					# And tally our numbers for performance purposes.
					add_to_global_variable_list = {
						name = laamps_tally
						target = this.primary_title
					}
				}
				### EP3 ADMIN SETUP ###
				if = {
					limit = { government_allows = administrative }
					save_scope_as = top_liege
					### EP3 NOBLE FAMILIES & DOMICILE SETUP ###
					random_held_title = { # May be removed once every_noble_family includes liege (TIT-51212)
						limit = { is_noble_family_title = yes }
						set_coa = scope:top_liege.house
					}
					every_noble_family = {
						# Ensure Noble Family CoA match House
						set_coa = holder.house
						# Ensure holders of historical noble family titles are the default house heads
						holder ?= {
							save_scope_as = nf_holder
							if = {
								limit = { is_landed = yes }
								capital_province = { save_scope_as = domicile_location }
							}
							house ?= {
								if = {
									limit = { house_head != scope:nf_holder }
									set_house_head = scope:nf_holder
								}
							}
						}
						set_color_from_title = scope:nf_holder.capital_county
					}
				}
			}
		}
		# Stormwind naming
		title:k_stormwind = {
			if = {
				limit = {
					has_game_rule = azeroth_name_of_stormwind
				}
				set_title_name = e_azeroth
			}
			else_if = {
				limit = {
					has_game_rule = azerothien_name_of_stormwind
				}
				set_title_name = k_azerothien
			}
		}
		culture:azerothian = {
			if = {
				limit = {
					has_game_rule = azeroth_name_of_stormwind
				}
				set_culture_name = {
					noun = azerothian_alt
					collective_noun = azerothian_alt_collective_noun
					prefix = azerothian_alt_prefix
				}
			}
			else_if = {
				limit = {
					has_game_rule = azerothien_name_of_stormwind
				}
				set_culture_name = {
					noun = azerothien
					collective_noun = azerothien_collective_noun
					prefix = azerothien_prefix
				}
			}
		}
		title:e_azeroth = {
			if = {
				limit = {
					has_game_rule = azerothien_name_of_stormwind
				}
				set_title_name = k_azerothien
			}
		}
		# Saharan stuff. [Warcraft - removed]
		# 1066 Buildings [Warcraft - removed]
		# 1178 Buildings [Warcraft - removed]
		if = {
			every_domicile = {
				# if = { # Left in if we want adventurers to spawn with stuff
				# 	limit = {
				# 		is_domicile_type = camp
				# 	}
				# 	add_domicile_building = camp_main_02
				# 	add_domicile_building = camp_main_03
				# 	random_list = {
				# 		10 = {
				# 			add_domicile_building = supply_tent_01
				# 			add_domicile_building = supply_tent_02
				# 			random_list = {
				# 				10 = {
				# 					add_domicile_building = supply_tent_sutler
				# 				}
				# 				10 = {
				# 					add_domicile_building = supply_tent_mender
				# 				}
				# 				10 = {
				# 					add_domicile_building = supply_tent_smithy
				# 				}
				# 				10 = {
				# 					add_domicile_building = supply_tent_arsenal
				# 				}
				# 			}
				# 		}
				# 		10 = {
				# 			add_domicile_building = barber_tent_01
				# 			add_domicile_building = barber_tent_02
				# 			random_list = {
				# 				10 = {
				# 					add_domicile_building = barber_tent_surgeons_tools
				# 				}
				# 				10 = {
				# 					add_domicile_building = barber_tent_dentists_tools
				# 				}
				# 				10 = {
				# 					add_domicile_building = barber_tent_torturers_tools
				# 				}
				# 			}
				# 		}
				# 		10 = {
				# 			add_domicile_building = baggage_train_01
				# 			add_domicile_building = baggage_train_02
				# 			random_list = {
				# 				10 = {
				# 					add_domicile_building = baggage_train_ample_steeds
				# 				}
				# 				10 = {
				# 					add_domicile_building = baggage_train_porters
				# 				}
				# 				10 = {
				# 					add_domicile_building = baggage_train_trackers
				# 				}
				# 				10 = {
				# 					add_domicile_building = baggage_train_kennel
				# 				}
				# 			}
				# 		}
				# 	}
				# 	random_list = {
				# 		10 = {
				# 			add_domicile_building = mess_tent_01
				# 			add_domicile_building = mess_tent_02
				# 			random_list = {
				# 				10 = {
				# 					add_domicile_building = mess_tent_herbalists
				# 				}
				# 				10 = {
				# 					add_domicile_building = mess_tent_brewers
				# 				}
				# 				10 = {
				# 					add_domicile_building = mess_tent_curers
				# 				}
				# 				10 = {
				# 					add_domicile_building = mess_tent_bakers
				# 				}
				# 				10 = {
				# 					add_domicile_building = mess_tent_cooks
				# 				}
				# 			}
				# 		}
				# 		10 = {
				# 			add_domicile_building = camp_fire_01
				# 			add_domicile_building = camp_fire_02
				# 			random_list = {
				# 				10 = {
				# 					add_domicile_building = camp_fire_trailing_musicians
				# 				}
				# 				10 = {
				# 					add_domicile_building = camp_fire_wandering_poets
				# 				}
				# 				10 = {
				# 					add_domicile_building = camp_fire_capering_fools
				# 				}
				# 				10 = {
				# 					add_domicile_building = camp_fire_libations_for_the_lost
				# 				}
				# 			}
				# 		}
				# 	}
				# 	random_list = {
				# 		10 = {
				# 			add_domicile_building = camp_perimeter_01
				# 			add_domicile_building = camp_perimeter_02
				# 			random_list = {
				# 				10 = {
				# 					add_domicile_building = camp_perimeter_good_siting
				# 				}
				# 				10 = {
				# 					add_domicile_building = camp_perimeter_fixed_layout
				# 				}
				# 			}
				# 		}
				# 		10 = {
				# 			add_domicile_building = proving_grounds_01
				# 			add_domicile_building = proving_grounds_02
				# 		}
				# 	}
				# }
				if = {
					limit = {
						is_domicile_type = estate
						exists = owner
					}
					if = {
						limit = {
							NOT = { has_domicile_building_or_higher = estate_main_02 }
							owner.culture ?= { has_innovation = innovation_city_planning }
						}
						add_domicile_building = estate_main_02
						add_random_internal_estate_building = yes
					}
					if = {
						limit = {
							has_domicile_building = estate_main_02
							NOT = { has_domicile_building_or_higher = estate_main_03 }
							owner.culture ?= { has_innovation = innovation_manorialism }
						}
						add_domicile_building = estate_main_03
						while = {
							count = 2
							add_random_internal_estate_building = yes
						}
					}

					fill_external_estate_building_effect = yes
					# Warcraft - Todo: make an effect to add estate buildings here if needed
				}
			}
		}
		# Purge family titles if Admin isn't enabled
		if = {
			limit = {
				NOT = { has_dlc_feature = roads_to_power }
			}
			every_ruler = {
				save_temporary_scope_as = this_ruler
				every_held_title = {
					limit = {
						is_noble_family_title = yes
						title_domicile ?= {
							is_domicile_type = estate
						}
					}
					scope:this_ruler = {
						destroy_title = prev
					}
				}
			}
		}

		#every_county_in_region = {
		#	region = world_steppe
		#	limit = {
		#		uses_county_fertility = yes
		#	}

		#	if = {
		#		limit = {
		#			holder = {
		#				government_has_flag = government_is_nomadic
		#			}
		#			county_fertility > 20
		#			county_fertility <= 90
		#		}
		#		switch = {
		#			trigger = holder.primary_title.tier
		#			tier_empire = {
		#				change_county_fertility = { 16 32 }
		#			}
		#			tier_kingdom = {
		#				change_county_fertility = { 12 16 }
		#			}
		#			tier_duchy = {
		#				change_county_fertility = { 8 12 }
		#			}
		#			tier_county = {
		#				change_county_fertility = { 2 8 }
		#			}
		#		}
		#	}
		#	else_if = {
		#		limit = {
		#			holder = {
		#				government_has_flag = government_is_herder
		#			}
		#		}
		#		change_county_fertility = { 44 64 }
 		#	}
		#}

		# Conquerors
		#todo warcraft adapt
		#example
		# character:144133 ?= {
		# 	if = {
		# 		limit = {
		# 			is_alive = yes
		# 			NOT = { has_game_rule = no_conquerors_frequency }
		# 		}
		# 		create_story = story_conqueror
		# 	}
		# }
		#character:144141 ?= {
		#	if = {
		#		limit = {
		#			is_alive = yes
		#			NOT = { has_game_rule = no_conquerors_frequency }
		#		}
		#		create_story = story_conqueror
		#	}
		#}
		#character:175080 ?= {
		#	if = {
		#		limit = {
		#			is_alive = yes
		#			NOT = { has_game_rule = no_conquerors_frequency }
		#		}
		#		create_story = story_conqueror
		#	}
		#}
		#character:226000 ?= {
		#	if = {
		#		limit = {
		#			is_alive = yes
		#			NOT = { has_game_rule = no_conquerors_frequency }
		#		}
		#		create_story = story_conqueror
		#	}
		#}
		
		every_player = {
			limit = {
				is_landed = yes
			}
			while = {
				count = 7
				limit = {
					any_courtier = {
						count < 7
						is_adult = yes
					}
				}
				save_scope_as = player_scope
				random_list = {
					1 = {
						create_character = {
							employer = scope:player_scope
							age = { 20 30 }
							random_traits = yes
							gender_female_chance = scope:player_scope.marriage_gender_adjusted_female_chance
							culture = scope:player_scope.culture
							faith = scope:player_scope.faith
							after_creation = {
								random_list = {
									200 = {
										# Character is of average weight, nothing happens
									}
									25 = {
										change_current_weight = -25
									}
									25 = {
										change_current_weight = -75
									}
									25 = {
										change_current_weight = 25
									}
									25 = {
										change_current_weight = 75
									}
									5 = {
										change_current_weight = 150
									}
								}
							}
						}
					}
					4 = {
						create_character = {
							employer = scope:player_scope
							age = { 20 40 }
							random_traits = yes
							gender_female_chance = 15
							culture = scope:player_scope.culture
							faith = scope:player_scope.faith
							after_creation = {
								random_list = {
									200 = {
										# Character is of average weight, nothing happens
									}
									25 = {
										change_current_weight = -25
									}
									25 = {
										change_current_weight = -75
									}
									25 = {
										change_current_weight = 25
									}
									25 = {
										change_current_weight = 75
									}
									5 = {
										change_current_weight = 150
									}
								}
							}
						}
					}
				}
			}
		}

		# Sanity check the setup if in debug mode
		if = {
        	limit = {
        		debug_only = yes
        	}
	        run_setup_tests_effect = yes
    	}
		set_global_variable = game_has_started

		every_independent_ruler = {
			# Treasury setup for any government using treasury
			tgp_treasury_setup_effect = yes
		}

		# TGP China education track switch

		if = {
			limit = {
				exists = title:h_pandaria.holder #Warcraft
			}
			title:h_pandaria.holder = {
				add_to_list = realm_potential_education_flip_list
			}
		}
		#if = {
		#	limit = {
		#		exists = title:e_goryeo.holder
		#	}
		#	title:e_goryeo.holder = {
		#		add_to_list = realm_potential_education_flip_list
		#	}
		#}
		#if = {
		#	limit = {
		#		exists = title:k_dali.holder
		#	}
		#	title:k_dali.holder = {
		#		add_to_list = realm_potential_education_flip_list
		#	}
		#}
		#if = {
		#	limit = {
		#		exists = title:k_viet.holder
		#	}
		#	title:k_viet.holder = {
		#		add_to_list = realm_potential_education_flip_list
		#	}
		#}
		#if = {
		#	limit = {
		#		exists = title:k_xia.holder
		#	}
		#	title:k_xia.holder = {
		#		add_to_list = realm_potential_education_flip_list
		#	}
		#}
		#if = {
		#	limit = {
		#		exists = title:e_andong.holder
		#	}
		#	title:e_andong.holder = {
		#		add_to_list = realm_potential_education_flip_list
		#	}
		#}

		every_in_list = {
			list = realm_potential_education_flip_list
			every_vassal_or_below = {
				limit = {
					is_ai = yes
					OR = {
						AND = {
							OR = {
								vassal_contract_has_flag = celestial_province_military
								vassal_contract_has_flag = celestial_province_protectorate
							}
							has_trait_with_flag = civilian_province
						}
						AND = {
							OR = {
								vassal_contract_has_flag = celestial_province_standard
								vassal_contract_has_flag = celestial_province_industrial
								vassal_contract_has_flag = celestial_province_metropolitan
							}
							has_trait_with_flag = military_province
						}
					}
				}
				tgp_flip_education_track_on_game_start = yes
			}
		}
		
		#Warcraft
		title:k_goblin_bankers.holder = {
			create_story = {
				type = story_cycle_goblin_loan
			}
		}
	}

	events = {
		# Warcraft
		# game_rule.1011	#Hungarian Migration management.
		historical_artifacts.0023			# Historical Artifacts Generator
		coronation_events.0302 # ACH crown giveaway
		
		# Warcraft
		wc_horde_invasion.0001 #Starts the Horde Invasion
		WCSS.1	
	}
}

#$CHARACTER$.house = {
#			save_scope_as = character_house
#
#			add_unity_value = {
#				value = {
#					value = $VALUE$
#					if = { # House heads have a larger impact on unity
#						limit = { house_head = $CHARACTER$ }
#						multiply = unity_house_head_multiplier_value
#					}
#				}
#				character = $CHARACTER$
#				desc = $DESC$
#			}
#		}


# Tags:
# rank_headgear: any headgear that signifies a certain title. crowns, pope hat etc.

headgear_base = {

	usage = game
	selection_behavior = weighted_random
	priority = 1

## SP4 Crowns of the World ## 

	sp4_mena_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sp4_mena_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
            modifier = {
                add = 30
                has_sp4_dlc_trigger = yes    
                portrait_royalty_trigger = {
                    CULTURE_INPUT = mena
                }           
            }
            modifier = {
                add = 60
                has_sp4_dlc_trigger = yes    
                portrait_royalty_trigger = {
                    CULTURE_INPUT = turkic
                }           
            }
            modifier = {
                factor = 0 # Should NOT show up if we're not in the right era
                OR = {
                    portrait_era1_trigger = yes   
                    portrait_era2_trigger = yes   
                }            
            }
		}
	}

	sp4_rus_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sp4_rus_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
            modifier = {
                add = 100
                has_sp4_dlc_trigger = yes    
                portrait_royalty_trigger = {
                    CULTURE_INPUT = rus
                }           
            }
            modifier = {
                add = -50
                has_pol_dlc_trigger = yes    
                portrait_royalty_trigger = {
                    CULTURE_INPUT = west_slavic
                } 
                OR = {
                    portrait_era3_trigger = yes   
                    portrait_era4_trigger = yes   
                }           
            }
		}
	}

	sp4_western_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sp4_western_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
            modifier = {
                add = 50
                has_sp4_dlc_trigger = yes    
                portrait_royalty_trigger = {
                    CULTURE_INPUT = western
                }           
            }
            modifier = {
                factor = 0 # Should NOT show up if we're not in the right era
                OR = {
                    portrait_era1_trigger = yes   
                    portrait_era2_trigger = yes   
                }            
            }
		}
	}

## SP3 ## 

	sp3_western_royalty_era3 = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sp3_western_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era1_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
            modifier = {
                add = 100
                has_dlc_feature = couture_of_the_capets     
                portrait_royalty_trigger = {
                    CULTURE_INPUT = western
                }           
                portrait_royalty_trigger = {
                    CULTURE_INPUT = french
                } 
            }
			modifier = {
				add = 90
				has_dlc_feature = couture_of_the_capets
				portrait_royalty_trigger = {
					CULTURE_INPUT = western
				}					
			}
            modifier = {
                factor = 0 # Should NOT show up if EP2 is active and we're not in the right era
                has_ep2_dlc_trigger = yes 
                OR = {
                    portrait_era1_trigger = yes   
                    portrait_era2_trigger = yes   
                }     
                NAND = {
                	portrait_era1_trigger = no
                    portrait_royalty_trigger = {
                        CULTURE_INPUT = french
                    } 
                }        
            }
		}
	}

	sp3_western_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sp3_western_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				is_female = no
				has_dlc_feature = couture_of_the_capets
				portrait_high_nobles_headgear_trigger = {
					CULTURE_INPUT = western
				}	
			}
            modifier = {
                factor = 0
                has_ep2_dlc_trigger = yes 
                OR = {
                    portrait_era1_trigger = yes   
                    portrait_era2_trigger = yes   
                }     
                NAND = {
                    portrait_era1_trigger = no
                    portrait_royalty_trigger = {
                        CULTURE_INPUT = french
                    } 
                }         
            }
		}
	}

	sp3_western_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sp3_western_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				is_female = yes
				has_dlc_feature = couture_of_the_capets
				portrait_low_nobles_clothing_trigger = {
					CULTURE_INPUT = western
				}	
			}
			modifier = {
				factor = 0
				has_ep2_dlc_trigger = yes
				NOR = {
					portrait_era3_trigger = yes 
					portrait_era4_trigger = yes
				}
			}
		}
	}

## SP2 ## 
	
	sp2_western_imperial_era1 = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sp2_western_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era1_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 90
				has_dlc_feature = elegance_of_the_empire
				OR = {
					portrait_imperial_trigger = {
						CULTURE_INPUT = western_goblin_dwarven_gnomish
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = northern
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = ugro_permian
					}					
				}
			}
			modifier = {
				add = 90
				has_dlc_feature = elegance_of_the_empire
				OR = {
					portrait_royalty_trigger = {
						CULTURE_INPUT = western_goblin_dwarven_gnomish
					}	
					portrait_imperial_trigger = {
						CULTURE_INPUT = western_goblin_dwarven_gnomish
					}	
					portrait_royalty_trigger = {
						CULTURE_INPUT = northern
					}	
					portrait_imperial_trigger = {
						CULTURE_INPUT = northern
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = ugro_permian
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = ugro_permian
					}					
				}
				is_female = yes
			}
            modifier = {
				factor = 0	   # Should NOT show up if EP2 is active and we're not in the right era
                has_ep2_dlc_trigger = yes 
                NOT = {
                	portrait_era1_trigger = yes 
                }  
            }
		}
	}

	sp2_western_imperial_era2 = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sp2_western_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era2_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 90
				has_dlc_feature = elegance_of_the_empire
				OR = {
					portrait_imperial_trigger = {
						CULTURE_INPUT = western_goblin_dwarven_gnomish
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = northern
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = ugro_permian
					}						
				}
			}
			modifier = {
				add = 90
				has_dlc_feature = elegance_of_the_empire
				OR = {
					portrait_royalty_trigger = {
						CULTURE_INPUT = western_goblin_dwarven_gnomish
					}	
					portrait_imperial_trigger = {
						CULTURE_INPUT = western_goblin_dwarven_gnomish
					}	
					portrait_royalty_trigger = {
						CULTURE_INPUT = northern
					}	
					portrait_imperial_trigger = {
						CULTURE_INPUT = northern
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = ugro_permian
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = ugro_permian
					}				
				}
				is_female = yes
			}
            modifier = {
				factor = 0	   # Should NOT show up if EP2 is active and we're not in the right era
                has_ep2_dlc_trigger = yes 
                NOT = {
                	portrait_era2_trigger = yes 
                }  
            }
		}
	}

	sp2_western_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sp2_western_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era2_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				has_dlc_feature = elegance_of_the_empire
				portrait_high_nobles_headgear_trigger = {
					CULTURE_INPUT = western_goblin_dwarven_gnomish
				}	
				# Warcraft
				is_garithos_trigger = no
			}
			modifier = {
				factor = 0
				has_ep2_dlc_trigger = yes
				NOR = {
					portrait_era2_trigger = yes 
					portrait_era3_trigger = yes
				}
			}
		}
	}


## DDE HRE ##

	dde_hre_commoners = {

		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dde_hre_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 20
                portrait_commoner_clothing_trigger = {  
                    CULTURE_INPUT = dde_hre # CULTURE_INPUT gets added into the trigger referenced in 00_clothing_triggers.txt so it's important the input is a correct match to an existing culture trigger
                }
			}
            modifier = {
				factor = 0	   # Should NOT show up if EP2 is active and we're not in the right era
                has_ep2_dlc_trigger = yes   
                NOR = { 
                	portrait_era3_trigger = yes 
                	portrait_era4_trigger = yes 
                } 
            }
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

	dde_hre_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dde_hre_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = dde_hre } # common/scripted_modifiers/00_portrait_modifiers.txt
			modifier = {
				add = 50
				portrait_low_nobles_clothing_trigger = {
					CULTURE_INPUT = dde_hre
				}
			}
            modifier = {
				factor = 0	   # Should NOT show up if EP2 is active and we're not in the right era
                has_ep2_dlc_trigger = yes   
                NOR = { 
                	portrait_era3_trigger = yes 
                	portrait_era4_trigger = yes 
                } 
            }
		}
	}

	dde_hre_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dde_hre_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era3_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_high_nobles_headgear_trigger = {
					CULTURE_INPUT = dde_hre
				}	
			}
            modifier = {
				factor = 0	   # Should NOT show up if EP2 is active and we're not in the right era
                has_ep2_dlc_trigger = yes   
                NOR = { 
                	portrait_era3_trigger = yes 
                	portrait_era4_trigger = yes 
                } 
            }
		}
	}

	dde_hre_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dde_hre_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era3_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_royalty_trigger = {
					CULTURE_INPUT = dde_hre
				}	
			}
            modifier = {
				factor = 0	   # Should NOT show up if EP2 is active and we're not in the right era
                has_ep2_dlc_trigger = yes   
                NOR = { 
                	portrait_era3_trigger = yes 
                	portrait_era4_trigger = yes 
                } 
            }
		}
	}

	# Reichskrone
	dde_hre_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dde_hre_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era2_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100 # always pick the HRE crown over the western one
				portrait_reichskrone_trigger = yes
			}
		}
	}

## Western ##

	western_commoners = {

		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = western
				}
				NOT = { has_ep2_dlc_trigger = yes }
			}
			modifier = {
				add = 20
				portrait_commoner_clothing_trigger = {
					CULTURE_INPUT = western
				}
				NOT = { has_ep2_dlc_trigger = yes }
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

    ep2_western_era1_commoners = {
        dna_modifiers = {
            accessory = {
                mode = add
                gene = headgear
                template = ep2_western_era1_common
                range = { 0 1 } # For the randomness to work correctly
            }
        }   
        weight = {
            base = 0
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = western
				}
				has_ep2_dlc_trigger = yes 
				portrait_era1_trigger = yes 
			}
            modifier = {
                add = 20
                portrait_commoner_clothing_trigger = { 
                    CULTURE_INPUT = western
                } 
                has_ep2_dlc_trigger = yes   
                portrait_era1_trigger = yes     
            }
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
        }
    }

    ep2_western_era2_commoners = {
        dna_modifiers = {
            accessory = {
                mode = add
                gene = headgear
                template = western_common
                range = { 0 1 } # For the randomness to work correctly
            }
        }   
        weight = {
            base = 0
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = western
				}
				has_ep2_dlc_trigger = yes 
				portrait_era2_trigger = yes 
			}
            modifier = {
                add = 20
                portrait_commoner_clothing_trigger = { 
                    CULTURE_INPUT = western
                } 
                has_ep2_dlc_trigger = yes   
                portrait_era2_trigger = yes     
            }
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
        }
    }

    ep2_western_era3_commoners = {
        dna_modifiers = {
            accessory = {
                mode = add
                gene = headgear
                template = ep2_western_era3_common
                range = { 0 1 } # For the randomness to work correctly
            }
        }   
        weight = {
            base = 0
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = western
				}
				has_ep2_dlc_trigger = yes 
				portrait_era3_trigger = yes 
			}
            modifier = {
                add = 20
                portrait_commoner_clothing_trigger = { 
                    CULTURE_INPUT = western
                } 
                has_ep2_dlc_trigger = yes   
                portrait_era3_trigger = yes     
            }
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
        }
    }

    fp4_western_era3_commoners = {
        dna_modifiers = {
            accessory = {
                mode = add
                gene = headgear
                template = fp4_western_era3_common
                range = { 0 1 } # For the randomness to work correctly
            }
        }   
        weight = {
            base = 0
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = western
				}
				portrait_era3_trigger = yes 
			}
            modifier = {
                add = 20
                portrait_commoner_clothing_trigger = { 
                    CULTURE_INPUT = western
                } 
                portrait_era3_trigger = yes     
            }
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
        }
    }

	western_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
		    modifier = {
		        add = 50
		        court_fashion_level_4_headgear_trigger = {
		            CULTURE_INPUT = western_dwarven
		        }
		        has_ep2_dlc_trigger = yes 
		        portrait_era1_trigger = yes 
		    }
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {  
                    CULTURE_INPUT = western_dwarven 
                }
                NOT = { has_ep2_dlc_trigger = yes }
			}
		}
	}

	ep2_western_era1_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep2_western_era1_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
		    modifier = {
		        add = 50
		        court_fashion_level_4_headgear_trigger = {
		            CULTURE_INPUT = western_dwarven
		        }
		        has_ep2_dlc_trigger = yes 
		        portrait_era1_trigger = yes 
		    }
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {  
                    CULTURE_INPUT = western_dwarven 
                }
                has_ep2_dlc_trigger = yes
                portrait_era1_trigger = yes  
			}
		}
	}

	ep2_western_era2_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
		    modifier = {
		        add = 50
		        court_fashion_level_4_headgear_trigger = {
		            CULTURE_INPUT = western_dwarven
		        }
		        has_ep2_dlc_trigger = yes 
		        portrait_era2_trigger = yes 
		    }
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {  
                    CULTURE_INPUT = western_dwarven 
                }
                has_ep2_dlc_trigger = yes
                portrait_era2_trigger = yes  
			}
		}
	}

	ep2_western_era3_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep2_western_era3_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
		    modifier = {
		        add = 50
		        court_fashion_level_4_headgear_trigger = {
		            CULTURE_INPUT = western_dwarven
		        }
		        has_ep2_dlc_trigger = yes 
		        portrait_era3_trigger = yes 
		    }
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {  
                    CULTURE_INPUT = western_dwarven 
                }
                has_ep2_dlc_trigger = yes
                OR = {
                	portrait_era3_trigger = yes  
                	portrait_era4_trigger = yes  
                }
			}
		}
	}

	fp4_western_era3_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp4_western_low_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
		    modifier = {
		        add = 50
		        court_fashion_level_4_headgear_trigger = {
		            CULTURE_INPUT = western
		        }
		        has_ce1_dlc_trigger = yes
                OR = {
                	portrait_era3_trigger = yes  
                	portrait_era4_trigger = yes  
                }
		    }
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {  
                    CULTURE_INPUT = western 
                }
                has_ce1_dlc_trigger = yes
                OR = {
                	portrait_era3_trigger = yes  
                	portrait_era4_trigger = yes  
                }
			}
		}
	}

	western_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = western_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {  
                    CULTURE_INPUT = wc_west_high_noble
                }
                NOT = { has_ep2_dlc_trigger = yes }
			}
		}
	}

	ep2_western_era1_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep2_western_era1_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era1_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {  
                    CULTURE_INPUT = wc_west_high_noble
                }
                has_ep2_dlc_trigger = yes
                portrait_era1_trigger = yes  
			}
		}
	}

	ep2_western_era2_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era2_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {  
                    CULTURE_INPUT = wc_west_high_noble
                }
                has_ep2_dlc_trigger = yes
                portrait_era2_trigger = yes  
			}
		}
	}

	ep2_western_era3_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era3_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {  
                    CULTURE_INPUT = wc_west_high_noble
                }
                has_ep2_dlc_trigger = yes
                OR = {
                	portrait_era3_trigger = yes  
                	portrait_era4_trigger = yes  
                }
			}
		}
	}

	western_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = western_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_royalty_trigger = {
					CULTURE_INPUT = western 
				}
				NOT = { has_ep2_dlc_trigger = yes }
			}
		}
	}

	ep1_western_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_western_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = western_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_royalty_trigger = {
					CULTURE_INPUT = western 
				}
			}
			modifier = {
				factor = 0
				NOT = {
					has_ep1_dlc_trigger = yes
				}
			}
            modifier = {
				factor = 0	   # Should NOT show up if EP2 is active and we're not in the right era
                has_ep2_dlc_trigger = yes 
                NOT = {
                	portrait_era2_trigger = yes  
                }  
            }
		}
	}

	ep1_western_era1_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_western_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era1_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_royalty_trigger = {
					CULTURE_INPUT = western 
				}
			}
			modifier = {
				factor = 0
				NOT = {
					has_ep1_dlc_trigger = yes
				}
			}
            modifier = {
				factor = 0	   # Should NOT show up if EP2 is active and we're not in the right era
                has_ep2_dlc_trigger = yes 
                NOT = {
                	portrait_era1_trigger = yes
                }  
            }
		}
	}

	ep2_western_era1_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep2_western_era1_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era1_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_royalty_trigger = {  
                    CULTURE_INPUT = western 
                }
                has_ep2_dlc_trigger = yes
                portrait_era1_trigger = yes  
			}
		}
	}

	ep2_western_era2_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era2_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_royalty_trigger = {  
                    CULTURE_INPUT = western 
                }
                has_ep2_dlc_trigger = yes
                portrait_era2_trigger = yes  
			}
			modifier = {
				factor = 0
				has_ce1_dlc_trigger = yes
			}
		}
	}

	ep2_western_era3_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_era3_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era3_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_royalty_trigger = {  
                    CULTURE_INPUT = western 
                }
                has_ep2_dlc_trigger = yes
                OR = {
                	portrait_era3_trigger = yes
                	portrait_era4_trigger = yes
                }  
			}
		}
	}

	ep1_italian_royalty = { # The Iron Crown of Lombardy
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_italian_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = western_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_royalty_trigger = {
					CULTURE_INPUT = wc_west_high_noble
				}
				has_ep1_dlc_trigger = yes
			}
		}
	}

	fp4_western_era2_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp4_western_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era2_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_royalty_trigger = {  
                    CULTURE_INPUT = wc_west_high_noble 
                }
                has_ce1_dlc_trigger = yes
                portrait_era2_trigger = yes  
			}
		}
	}

	western_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = western_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_imperial_trigger = {
					CULTURE_INPUT = western_dwarven 
				}
				NOT = { has_ep2_dlc_trigger = yes }
			}
			modifier = {
				add = 50
				OR = {
					portrait_imperial_trigger = {
						CULTURE_INPUT = northern 
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = ugro_permian
					}
				}
				NOT = { has_ep2_dlc_trigger = yes }
			}
		}
	}

	ep2_western_era1_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep2_western_era1_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era1_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_imperial_trigger = {  
                    CULTURE_INPUT = western_dwarven 
                }
                has_ep2_dlc_trigger = yes
                portrait_era1_trigger = yes  
			}
			modifier = {
				add = 50
				OR = {
					portrait_imperial_trigger = {  
						CULTURE_INPUT = northern 
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = ugro_permian
					}
				}
                has_ep2_dlc_trigger = yes
                portrait_era1_trigger = yes  
			}
		}
	}

	ep2_western_era2_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era2_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_imperial_trigger = {  
                    CULTURE_INPUT = western_dwarven 
                }
                has_ep2_dlc_trigger = yes
                OR = {
                	portrait_era2_trigger = yes
                	portrait_era3_trigger = yes
                }  
			}
			modifier = {
				add = 50
				OR = {
					portrait_imperial_trigger = {  
						CULTURE_INPUT = northern 
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = ugro_permian
					}
				}
                has_ep2_dlc_trigger = yes
                OR = {
                	portrait_era2_trigger = yes
                	portrait_era3_trigger = yes
                }  
			}
		}
	}

	ep2_western_era4_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = ep2_western_era3_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_imperial_trigger = {  
                    CULTURE_INPUT = western_dwarven 
                }
                has_ep2_dlc_trigger = yes
                OR = {
                	portrait_era4_trigger = yes
                }  
			}
			modifier = {
				add = 50
				OR = {
					portrait_imperial_trigger = {  
						CULTURE_INPUT = northern 
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = ugro_permian
					}
				}
                has_ep2_dlc_trigger = yes
                OR = {
                	portrait_era4_trigger = yes
                }  
			}
		}
	}

	#RTT headgear
	monarchs_journey_late_unlock = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = monarchs_journey_unleashed
				range = { 0 1 } # For the randomness to work correctly
			}
		}

		weight = {
			base = 0
			modifier = {
				add = 10
				current_date >= 550.1.1
				OR = {
					portrait_western_clothing_trigger = yes
					portrait_western_clothing_spouse_trigger = yes
				}
				OR = {
					AND = {
						is_lowborn = no
						is_female = yes
					}
					AND = {
						government_has_flag = government_is_republic
						highest_held_title_tier <= tier_barony
					}
				}
				trigger_if = {
					limit = {
						is_ruler = yes
					}
					primary_title.tier <= tier_duchy
				}
			}
			modifier = {
				add = 30
				portrait_era4_trigger = yes
                portrait_low_nobles_trigger = {
                    CULTURE_INPUT = basic_western
                }
			}
		}
	}

## Byzantine ##

	byzantine_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = byzantine_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
                portrait_commoner_headgear_fallback_trigger = {
                    CULTURE_INPUT = byzantine_gnomish
                }
			}
			modifier = {
				add = 20
                portrait_commoner_clothing_trigger = {
                    CULTURE_INPUT = byzantine
                }
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

	ep3_byzantine_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep3_byzantine_era1_commoner
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = byzantine
				}
				has_ep3_dlc_trigger = yes
				OR = {
					portrait_era1_trigger = yes
					portrait_era2_trigger = yes
				}
			}
			modifier = {
				add = 20
				portrait_commoner_clothing_trigger = {
					CULTURE_INPUT = byzantine
				}
				has_ep3_dlc_trigger = yes
				OR = {
					portrait_era1_trigger = yes
					portrait_era2_trigger = yes
				}
			}
		}
	}

	byzantine_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = byzantine_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = byzantine } 
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {  
                    CULTURE_INPUT = byzantine 
                }
			}
			modifier = {
				factor = 0
				has_ep3_dlc_trigger = yes
				portrait_era1_trigger = yes
			}
		}
	}

	ep3_byzantine_era1_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep3_byzantine_era1_low_nobility 
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
		    modifier = {
		        add = 50
		        court_fashion_level_4_headgear_trigger = {
		            CULTURE_INPUT = byzantine
		        }
		        has_ep3_dlc_trigger = yes 
		        portrait_era1_trigger = yes 
		    }
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {  
                    CULTURE_INPUT = byzantine 
                }
                has_ep3_dlc_trigger = yes
                portrait_era1_trigger = yes  
			}
		}
	}

	ep3_byzantine_era1_bare_headed_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = no_headgear 
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
		    modifier = {
		        add = 50
		        has_ep3_dlc_trigger = yes 
		        portrait_era1_trigger = yes 
		        OR = {
	                portrait_low_nobles_clothing_trigger = {  
	                    CULTURE_INPUT = byzantine 
	                }
	                portrait_high_nobles_clothing_trigger = {  
	                    CULTURE_INPUT = byzantine 
	                }
		        }
		        NOR = {
	                portrait_royalty_trigger = {  
	                    CULTURE_INPUT = byzantine 
	                }	
	                portrait_imperial_trigger = {  
	                    CULTURE_INPUT = byzantine 
	                }	        
		        }
		    }
		    modifier = {
		        add = 80
		        has_ep3_dlc_trigger = yes 
		        portrait_era1_trigger = yes 
                portrait_commoner_clothing_trigger = {  
                    CULTURE_INPUT = byzantine 
                }
		    }
		}
	}

	ep3_byzantine_era2_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep3_byzantine_era2_low_nobility 
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
		    modifier = {
		        add = 50
		        court_fashion_level_4_headgear_trigger = {
		            CULTURE_INPUT = byzantine
		        }
		        has_ep3_dlc_trigger = yes 
                OR = {
                    portrait_era2_trigger = yes  
                    portrait_era3_trigger = yes  
                    portrait_era4_trigger = yes  
                }  
		    }
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {  
                    CULTURE_INPUT = byzantine 
                }
                has_ep3_dlc_trigger = yes
                OR = {
                    portrait_era2_trigger = yes  
                    portrait_era3_trigger = yes  
                    portrait_era4_trigger = yes  
                }  
			}
		}
	}

	byzantine_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = byzantine_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = byzantine
                }   
			}
            modifier = {
                factor = 0 
                has_ep3_dlc_trigger = yes 
                portrait_era1_trigger = yes   
            }
		}
	}

	ep3_byzantine_era1_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep3_byzantine_era1_high_nobility 
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 10
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = byzantine
                }   
		        has_ep3_dlc_trigger = yes 
                portrait_era1_trigger = yes 
			}
		}
	}

	ep3_byzantine_era2_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep3_byzantine_era2_high_nobility 
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = byzantine
                }   
		        has_ep3_dlc_trigger = yes 
                OR = {
                    portrait_era2_trigger = yes  
                    portrait_era3_trigger = yes  
                    portrait_era4_trigger = yes  
                }  
			}
		}
	}

	byzantine_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = byzantine_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_royalty_trigger = {
                    CULTURE_INPUT = byzantine
                }   
			}
            modifier = {
                factor = 0     
                has_ep3_dlc_trigger = yes 
                portrait_era1_trigger = yes   
            }
		}
	}

	ep3_byzantine_era1_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep3_byzantine_era1_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 85
                portrait_royalty_trigger = {  
                    CULTURE_INPUT = byzantine 
                }
                has_ep3_dlc_trigger = yes
                portrait_era1_trigger = yes  
			}
		}
	}

    ep3_byzantine_era2_royalty = {
        dna_modifiers = {
            accessory = {
                mode = add
                gene = headgear
                template = ep3_byzantine_era2_royalty
                range = { 0 1 } # For the randomness to work correctly
            }
        }   
        weight = {
            base = 0
            modifier = {
                add = 85
                portrait_royalty_trigger = { 
                    CULTURE_INPUT = byzantine
                }                
                has_ep3_dlc_trigger = yes   
                OR = {
                    portrait_era2_trigger = yes  
                    portrait_era3_trigger = yes  
                    portrait_era4_trigger = yes  
                }     
            }
        }
    }

	byzantine_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = byzantine_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_imperial_trigger = {
                    CULTURE_INPUT = byzantine 
                }
			}
			modifier = {
				factor = 0
				has_ep3_dlc_trigger = yes
			}
		}
	}

	ep1_byzantine_imperial = { # Crown of Justinian
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_byzantine_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_imperial_trigger = {
					CULTURE_INPUT = byzantine 
				}
			}
			modifier = {
				factor = 0
				# Warcraft
				always = yes
			}
			modifier = {
				factor = 0
				NOT = {
					has_ep1_dlc_trigger = yes
				}
			}
            modifier = {
                factor = 0     
                has_ep3_dlc_trigger = yes 
                OR = {
                	portrait_era3_trigger = yes
                	portrait_era4_trigger = yes 
                }
            }
		}
	}

	ep3_byzantine_era1_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep3_byzantine_era1_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 85
                portrait_imperial_trigger = {  
                    CULTURE_INPUT = byzantine 
                }
                has_ep3_dlc_trigger = yes
                portrait_era1_trigger = yes  
			}
		}
	}

    ep3_byzantine_era2_imperial = {
        dna_modifiers = {
            accessory = {
                mode = add
                gene = headgear
                template = ep3_byzantine_era2_imperial
                range = { 0 1 } # For the randomness to work correctly
            }
        }   
        weight = {
            base = 0
            modifier = {
                add = 85
                portrait_imperial_trigger = { 
                    CULTURE_INPUT = byzantine
                }                
                has_ep3_dlc_trigger = yes   
                OR = {
                    portrait_era2_trigger = yes  
                    portrait_era3_trigger = yes  
                    portrait_era4_trigger = yes  
                }     
            }
        }
    }

## INDIAN ##

	indian_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = indian_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
                portrait_commoner_headgear_fallback_trigger = {
                    CULTURE_INPUT = indian_draenei
                }
			}
			modifier = { # Non-european jesters should not use the jester hat
				add = 1000
				portrait_jester_trigger = {  
                    CULTURE_INPUT = indian_draenei 
                }
			}
			modifier = {
				add = 20
				portrait_commoner_clothing_trigger = {  
                    CULTURE_INPUT = indian_draenei 
                }
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

	indian_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = indian_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = indian_draenei } 
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {  
                    CULTURE_INPUT = indian_draenei 
                }
			}
		}
	}

	indian_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = indian_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = indian_draenei
                }   
			}
		}
	}

	indian_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = indian_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_royalty_trigger = {
                    CULTURE_INPUT = indian_draenei
                }   
			}
		}
	}

	ep1_indian_royalty = { 
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_indian_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
				portrait_royalty_trigger = {
					CULTURE_INPUT = indian_draenei
				}
				culture = {
					like_heritage_burman_trigger = yes
				}
				has_ep1_dlc_trigger = yes
			}
		}
	}

	indian_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = indian_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_imperial_trigger = {
                    CULTURE_INPUT = indian_draenei 
                }
			}
		}
	}

	ep1_indian_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_indian_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
                portrait_imperial_trigger = {
                    CULTURE_INPUT = indian_draenei 
                }
				culture = {
					like_heritage_burman_trigger = yes
				}
				has_ep1_dlc_trigger = yes
			}
		}
	}

## MENA ##

	mena_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mena_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 80
                portrait_commoner_headgear_fallback_trigger = {
                    CULTURE_INPUT = mena
                }
			}
			modifier = { # Non-european jesters should not use the jester hat
				add = 1000
                portrait_jester_trigger = {  
                    CULTURE_INPUT = mena 
                }
			}
			modifier = {
				add = 20
                portrait_commoner_clothing_trigger = {
                    CULTURE_INPUT = mena
                }
			}
			modifier = {
				add = -36 # Slightly lower if north african is valid
				portrait_commoner_clothing_trigger = { 
					CULTURE_INPUT = afr_berber
				}
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

	mena_mayors = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mena_low_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 60
				portrait_mayor_headgear_trigger = {
					CULTURE_INPUT = mena
				}
			}
			modifier = {
				add = -36 # Slightly lower if north african is valid
				portrait_mayor_headgear_trigger = { 
					CULTURE_INPUT = afr_berber
				}
			}
		}
	}

	mena_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mena_low_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = mena } 
			modifier = {
				add = {
					value = 50
					if = {
						limit = {
							OR = {
								portrait_low_nobles_clothing_trigger = { 
									CULTURE_INPUT = fp3_iranian
								}
								portrait_low_nobles_clothing_trigger = { 
									CULTURE_INPUT = afr_berber
								}
							}
						}
						add = -36 # Slightly lower if iranian or north african is valid
					}
				}
                portrait_low_nobles_clothing_trigger = {
                    CULTURE_INPUT = mena
                }
			}
		}
	}

	mena_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mena_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = mena
                }   
			}
			modifier = {
				add = -36 # Slightly lower if iranian or north african is valid
				OR = {
					portrait_high_nobles_headgear_trigger = { 
						CULTURE_INPUT = fp3_iranian
					}
					portrait_high_nobles_headgear_trigger = { 
						CULTURE_INPUT = afr_berber
					}
				}
			}
		}
	}

	mena_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mena_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_royalty_trigger = {
                    CULTURE_INPUT = mena
                }   
			}
			modifier = {
				add = -36 # Slightly lower if iranian or north african is valid
				OR = {
					portrait_royalty_trigger = { 
						CULTURE_INPUT = fp3_iranian
					}
					portrait_royalty_trigger = { 
						CULTURE_INPUT = afr_berber
					}
				}
			}
		}
	}

	ep1_mena_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_mena_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0
			modifier = {
				add = 100
                portrait_royalty_trigger = {
                    CULTURE_INPUT = mena 
                }
				culture = culture:wastewander
				#religion = religion:islam_religion
				has_ep1_dlc_trigger = yes
			}
		}
	}

	mena_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mena_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_imperial_nobles_headgear_trigger = {
                    CULTURE_INPUT = mena 
                }
			}
			modifier = {
				add = -36 # Slightly lower if iranian or north african is valid
				OR = {
					portrait_imperial_nobles_headgear_trigger = { 
						CULTURE_INPUT = fp3_iranian
					}
					portrait_imperial_nobles_headgear_trigger = { 
						CULTURE_INPUT = afr_berber
					}
				}
			}
		}
	}

	ep1_persian_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_persian_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_imperial_nobles_headgear_trigger = {
                    CULTURE_INPUT = mena 
                }
                culture = {
                    like_heritage_iranian_trigger = yes
                }
                has_ep1_dlc_trigger = yes
			}
		}
	}

## DDE ABBASID ##

	dde_abbasid_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dde_abbasid_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 20
                portrait_commoner_clothing_trigger = {
                    CULTURE_INPUT = dde_abbasid
                }
			}
			modifier = {
				add = -36 # Slightly lower if north african is valid
				portrait_commoner_clothing_trigger = { 
					CULTURE_INPUT = afr_berber
				}
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

	dde_abbasid_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dde_abbasid_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = dde_abbasid
                } 
			}
			modifier = {
				add = -36 # Slightly lower if iranian or north african is valid
				OR = {
					portrait_high_nobles_headgear_trigger = { 
						CULTURE_INPUT = fp3_iranian
					}
					portrait_high_nobles_headgear_trigger = { 
						CULTURE_INPUT = afr_berber
					}
				}
			}
		}
	}

	dde_abbasid_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dde_abbasid_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_royalty_trigger = {
                    CULTURE_INPUT = dde_abbasid
                }  
			}
			modifier = {
				add = -36 # Slightly lower if north african is valid
				portrait_royalty_trigger = { 
					CULTURE_INPUT = afr_berber
				}
			}
			#modifier = {
			#	add = -36 # Slightly lower if iranian is valid
			#	portrait_royalty_trigger = { 
			#		CULTURE_INPUT = fp3_iranian
			#	}
			#}
		}
	}

	dde_abbasid_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dde_abbasid_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100 # pick over mena
                portrait_imperial_trigger = {
                    CULTURE_INPUT = dde_abbasid 
                }
			}
			modifier = {
				add = -56 # Slightly lower if iranian or north african is valid
				OR = {
					portrait_imperial_trigger = { 
						CULTURE_INPUT = fp3_iranian
					}
					portrait_imperial_trigger = { 
						CULTURE_INPUT = afr_berber
					}
				}
			}
		}
	}

## Steppe ##

	steppe_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = steppe_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
                portrait_commoner_headgear_fallback_trigger = {
                    CULTURE_INPUT = steppe_night_elven
                }
			}
			modifier = { # Non-european jesters should not use the jester hat
				add = 1000
                portrait_jester_trigger = {  
                    CULTURE_INPUT = steppe 
                }
				NOR = {
					portrait_western_clothing_trigger = yes
					portrait_byzantine_clothing_trigger = yes
					portrait_northern_clothing_trigger = yes
				}
			}
			modifier = {
				add = 20
                portrait_commoner_clothing_trigger = {  
                    CULTURE_INPUT = steppe 
                }
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

	mpo_mongol_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mpo_mongol_commoner
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 20
				portrait_commoner_clothing_trigger = {
					CULTURE_INPUT = steppe
				}
				has_mpo_dlc_trigger = yes
			}
		}
	}

	steppe_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = steppe_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = steppe } 
			modifier = {
				add = 50
                portrait_low_nobles_clothing_trigger = {
                    CULTURE_INPUT = steppe
                }
			}
		}
	}

	mpo_mongol_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mpo_mongol_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = steppe }
			modifier = {
				add = 50
				portrait_low_nobles_clothing_trigger = {
					CULTURE_INPUT = steppe
				}
				has_mpo_dlc_trigger = yes
			}
			modifier = {
				add = -50
				portrait_low_nobles_clothing_trigger = {
					CULTURE_INPUT = fp3_turkic
				}
			}
		}
	}

	steppe_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = steppe_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = steppe
                }   
			}
		}
	}

	steppe_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = steppe_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				OR = {
					portrait_imperial_trigger = {
						CULTURE_INPUT = steppe
					}   
					portrait_royalty_trigger = {
						CULTURE_INPUT = steppe
					}   
				}
			}
			modifier = {
				add = -10
				has_mpo_dlc_trigger = yes
			}
		}
	}

	ep1_steppe_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_steppe_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                OR = {
					portrait_imperial_trigger = {
						CULTURE_INPUT = steppe
					}   
					portrait_royalty_trigger = {
						CULTURE_INPUT = steppe
					}   
				}
			}
			modifier = {
				factor = 0
				NOR = {
					has_ep1_dlc_trigger = yes
					has_mpo_dlc_trigger = yes
			}
		}
	}
	}

	mpo_mongol_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mpo_mongol_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 85
				portrait_royalty_trigger = {
					CULTURE_INPUT = steppe
				}
				has_mpo_dlc_trigger = yes
			}
		}
	}

	mpo_mongol_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mpo_mongol_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 85
				portrait_imperial_trigger = {
					CULTURE_INPUT = steppe
				}
				has_mpo_dlc_trigger = yes
			}
			modifier = {
				add = -85
				portrait_imperial_trigger = {
					CULTURE_INPUT = fp3_turkic
				}
				has_mpo_dlc_trigger = yes
			}
		}
	}



## Northern Pagans ##

	northern_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = northern_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 70
                portrait_commoner_headgear_fallback_trigger = {
                    CULTURE_INPUT = northern
                }
			}
			modifier = {
				add = 30
                portrait_commoner_clothing_trigger = {
                    CULTURE_INPUT = northern
                }
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

	northern_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = northern_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = northern } 
			modifier = {
				add = 50
				OR = {
	                portrait_low_nobles_clothing_trigger = {
	                    CULTURE_INPUT = northern
	                }
				}
			}
		}
	}

	northern_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = northern_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = northern
                }   
			}
		}
	}

	northern_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = northern_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				OR = {
					portrait_royalty_trigger = {
						CULTURE_INPUT = northern
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = sami
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = ugro_permian
					}
				}
			}
		}
	}

## AFR ##

	afr_berber_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = afr_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
                portrait_commoner_headgear_fallback_trigger = {
                    CULTURE_INPUT = afr_berber
                }
			}
			modifier = {
				add = 21
                portrait_commoner_no_mayors_trigger = {
                    CULTURE_INPUT = afr_berber
                }
			}
		}
	}

	afr_berber_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = afr_low_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = afr_berber } 
			modifier = {
				add = 51
                portrait_low_nobles_clothing_trigger = {
                    CULTURE_INPUT = afr_berber
                }
			}
		}
	}

	afr_berber_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = afr_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = afr_berber
                }   
			}
		}
	}

	afr_berber_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = afr_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
                portrait_royalty_trigger = {
                    CULTURE_INPUT = afr_berber
                }   
			}
		}
	}

	afr_berber_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = afr_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 51
                portrait_imperial_nobles_headgear_trigger = {
                    CULTURE_INPUT = afr_berber 
                }
			}
		}
	}

## POL ##

	pol_west_slavic_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = pol_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 90
                portrait_commoner_headgear_fallback_trigger = {
                    CULTURE_INPUT = west_slavic
                }
			}
			modifier = {
				add = 30
                portrait_commoner_clothing_trigger = {
                    CULTURE_INPUT = west_slavic
                }
			}
		}
	}

	pol_west_slavic_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = pol_low_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = west_slavic } 
			modifier = {
				add = 80
                portrait_low_nobles_clothing_trigger = {
                    CULTURE_INPUT = west_slavic
                }
			}
		}
	}

	pol_west_slavic_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = pol_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = west_slavic
                }
			}
		}
	}

	pol_west_slavic_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = pol_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = western_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
                portrait_royalty_trigger = {
                    CULTURE_INPUT = west_slavic
                }
			}
			modifier = {
				factor = 0
				has_sp4_dlc_trigger = yes
				OR = {
					portrait_era1_trigger = yes
					portrait_era2_trigger = yes
				}
			}
		}
	}

	pol_west_slavic_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = pol_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
			accessory = { # Can be combined with veils
				mode = add
				gene = additive_headgear
				template = western_veils
				range = { 0 1 } # For the randomness to work correctly
			}
		}	
		weight = {
			base = 0
			modifier = {
				add = 100
                portrait_imperial_trigger = {
                    CULTURE_INPUT = west_slavic 
                }
			}
		}
	}

## CCP4 Sami ##

ccp4_sami_commoners = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = ccp4_sami_common
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		modifier = {
			add = 90
			portrait_commoner_headgear_fallback_trigger = {
				CULTURE_INPUT = sami
			}
		}
		modifier = {
			add = 30
			portrait_commoner_clothing_trigger = {
				CULTURE_INPUT = sami
			}
		}
	}
}

ccp4_sami_low_nobles = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = ccp4_sami_low_nobility
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = sami } 
		modifier = {
			add = 80
			portrait_low_nobles_clothing_trigger = {
				CULTURE_INPUT = sami
			}
		}
	}
}

ccp4_sami_high_nobles = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = ccp4_sami_high_nobility
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		modifier = {
			add = 80
			portrait_high_nobles_headgear_trigger = {
				CULTURE_INPUT = sami
			}
		}
	}
}

## CCP4 Khanty ##

ccp4_ugro_permian_commoners = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = ccp4_khanty_common
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		modifier = {
			add = 90
			portrait_commoner_headgear_fallback_trigger = {
				CULTURE_INPUT = ugro_permian
			}
		}
		modifier = {
			add = 30
			portrait_commoner_clothing_trigger = {
				CULTURE_INPUT = ugro_permian
			}
		}
	}
}

ccp4_ugro_permian_low_nobles = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = ccp4_khanty_low_nobility
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = ugro_permian } 
		modifier = {
			add = 80
			portrait_low_nobles_clothing_trigger = {
				CULTURE_INPUT = ugro_permian
			}
		}
	}
}

ccp4_ugro_permian_high_nobles = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = ccp4_khanty_high_nobility
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		modifier = {
			add = 80
			portrait_high_nobles_headgear_trigger = {
				CULTURE_INPUT = ugro_permian
			}
		}
	}
}	

## FP3 Iranian ##

fp3_iranian_low_nobles = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = fp3_iranian_low_nobility
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = fp3_iranian } 
		modifier = {
			add = 51 # Slightly higher
			portrait_low_nobles_clothing_trigger = {
				CULTURE_INPUT = fp3_iranian
			}
		}
	}
}

fp3_iranian_high_nobles = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = fp3_iranian_nobility
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		modifier = {
			add = 51 # Slightly higher
			portrait_high_nobles_headgear_trigger = {
				CULTURE_INPUT = fp3_iranian
			}   
		}
	}
}

fp3_iranian_royalty = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = fp3_iranian_royalty
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		modifier = {
			add = 51 # Slightly higher
			OR = {
			portrait_royalty_trigger = {
				CULTURE_INPUT = fp3_iranian
				}
				portrait_royalty_trigger = {
					CULTURE_INPUT = fp3_turkic
				}
			}   
		}
	}
}

fp3_iranian_imperial = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = fp3_iranian_imperial
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		modifier = {
			add = 51 # Slightly higher
			OR = {
			portrait_imperial_trigger = {
				CULTURE_INPUT = fp3_iranian
				}
				portrait_imperial_trigger = {
					CULTURE_INPUT = fp3_turkic
				}
			}   
		}
	}
}

## FP3 Turkic ##

fp3_turkic_low_nobles = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = fp3_turkic_low_nobility
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = fp3_turkic } 
		modifier = {
			add = 51 # Slightly higher
			portrait_low_nobles_clothing_trigger = {
				CULTURE_INPUT = fp3_turkic
			}
		}
	}
}

fp3_turkic_high_nobles = {
	dna_modifiers = {
		accessory = {
			mode = add
			gene = headgear
			template = fp3_turkic_nobility
			range = { 0 1 } # For the randomness to work correctly
		}
	}
	weight = {
		base = 0
		modifier = {
			add = 51 # Slightly higher
			portrait_high_nobles_headgear_trigger = {
				CULTURE_INPUT = fp3_turkic
			}   
		}
	}
}

## FP2 Iberian ##
	fp2_iberian_muslim_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp2_muslim_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#modifier = {
			#	add = 80
            #    portrait_commoner_headgear_fallback_trigger = {
            #        CULTURE_INPUT = fp2_iberian_muslim
            #    }
			#}
			#modifier = {
			#	add = 41 # Slightly higher
			#	portrait_commoner_no_mayors_trigger = {
            #        CULTURE_INPUT = fp2_iberian_muslim
            #    }
			#}
		}
	}

	fp2_iberian_muslim_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp2_muslim_low_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = fp2_iberian_muslim } 
			#modifier = {
			#	add = 51 # Slightly higher
            #    portrait_low_nobles_clothing_trigger = {
            #        CULTURE_INPUT = fp2_iberian_muslim
            #    }
			#}
		}
	}

	fp2_iberian_muslim_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp2_muslim_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#modifier = {
			#	add = 51 # Slightly higher
            #    portrait_high_nobles_headgear_trigger = {
            #        CULTURE_INPUT = fp2_iberian_muslim
            #    }   
			#}
		}
	}

	fp2_iberian_muslim_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp2_muslim_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#modifier = {
			#	add = 51 # Slightly higher
            #    portrait_royalty_trigger = {
            #        CULTURE_INPUT = fp2_iberian_muslim
            #    }  
			#}
		}
	}

	fp2_iberian_christian_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp2_christian_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		outfit_tags = { iberian_christian_shrimp_wrap }
		weight = {
			base = 0
			#modifier = {
			#	add = 80
            #    portrait_commoner_headgear_fallback_trigger = {
            #        CULTURE_INPUT = fp2_iberian_christian
            #    }
			#}
			#modifier = {
			#	add = 41 # Slightly higher
            #    portrait_commoner_clothing_trigger = {  
            #        CULTURE_INPUT = fp2_iberian_christian 
            #    }
			#}
            #modifier = {
            #    factor = 0       # Should NOT show up if EP2 is active and we're not in the right era
            #    has_ep2_dlc_trigger = yes   
            #    portrait_era1_trigger = yes
            #}
		}
	}

	fp2_iberian_christian_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp2_christian_low_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = fp2_iberian_christian } 
			#modifier = {
			#	add = 60 # Slightly higher
            #    portrait_low_nobles_clothing_trigger = {
            #        CULTURE_INPUT = fp2_iberian_christian
            #    }
			#}
            #modifier = {
            #    factor = 0       # Should NOT show up if EP2 is active and we're not in the right era
            #    has_ep2_dlc_trigger = yes   
            #    portrait_era1_trigger = yes 
            #}
		}
	}

	fp2_iberian_christian_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp2_christian_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#modifier = {
			#	add = 60 # Slightly higher
            #    portrait_high_nobles_headgear_trigger = {
            #        CULTURE_INPUT = fp2_iberian_christian
            #    } 
			#}
            #modifier = {
            #    factor = 0       # Should NOT show up if EP2 is active and we're not in the right era
            #    has_ep2_dlc_trigger = yes   
            #    portrait_era1_trigger = yes 
            #}
		}
	}

	fp2_iberian_christian_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp2_christian_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#modifier = {
			#	add = 51 # Slightly higher
            #    portrait_royalty_trigger = {
            #        CULTURE_INPUT = fp2_iberian_christian
            #    }  
			#}
            #modifier = {
            #    factor = 0       # Should NOT show up if EP2 is active and we're not in the right era
            #    has_ep2_dlc_trigger = yes   
            #    portrait_era1_trigger = yes 
            #}
		}
	}

## FP1 NORSE ##

	fp1_norse_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp1_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
                portrait_commoner_headgear_fallback_trigger = {
                    CULTURE_INPUT = fp1_norse
                }
			}
			modifier = {
				add = 41 # Slightly higher
                portrait_commoner_clothing_trigger = {  
                    CULTURE_INPUT = fp1_norse 
                }
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

	fp1_norse_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp1_low_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = fp1_norse } 
			modifier = {
				add = 51 # Slightly higher
                portrait_low_nobles_clothing_trigger = {
                    CULTURE_INPUT = fp1_norse
                }
			}
		}
	}

	fp1_norse_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp1_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51 # Slightly higher
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = fp1_norse_dwarven
                }   
			}
		}
	}

	fp1_norse_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp1_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51 # Slightly higher
				OR = {
					AND = {
						has_dlc_feature = the_northern_lords
		                portrait_royalty_trigger = {
		                    CULTURE_INPUT = northern
		                } 
					}
	                portrait_royalty_trigger = {
	                    CULTURE_INPUT = fp1_norse_dwarven
	                } 	                
				}  
			}
		}
	}

	fp1_norse_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = fp1_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100 # pick over northern
				OR = {
					AND = {
						has_dlc_feature = the_northern_lords
		                portrait_imperial_trigger = {
		                    CULTURE_INPUT = northern
		                } 
					}
	                portrait_imperial_trigger = {
	                    CULTURE_INPUT = fp1_norse_dwarven
	                } 	                
				}
			}
		}
	}

## Sub-Saharan Africans ##

	african_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sub_saharan_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_commoner_headgear_fallback_trigger = {
                    CULTURE_INPUT = african
                }
			}
			modifier = { # Non-european jesters should not use the jester hat
				add = 1000
                portrait_jester_trigger = {  
                    CULTURE_INPUT = african 
                }
			}
			modifier = {
				add = 50
                portrait_commoner_clothing_trigger = {  
                    CULTURE_INPUT = african 
                }
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}

	sub_saharan_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sub_saharan_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
                portrait_high_nobles_headgear_trigger = {
                    CULTURE_INPUT = african
                }   
			}
		}
	}

	sub_saharan_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sub_saharan_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_royalty_african_headgear_trigger = yes
			}
		}
	}

	ep1_sub_saharan_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = ep1_sub_saharan_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_royalty_african_headgear_trigger = yes
			}
			modifier = {
				factor = 0
				NOT = {
					has_ep1_dlc_trigger = yes
				}
			}
		}
	}

	sub_saharan_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = sub_saharan_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_imperial_nobles_headgear_trigger = {
					CULTURE_INPUT = african
				}
			}
		}
	}


	sub_saharan_war = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mena_war
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 100
                portrait_war_nobles_helmet_trigger = {
                    CULTURE_INPUT = african
                }
			}
		}
	}

	jester_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add

				gene = headgear
				template = ep1_jester
				range = { 0 1 }
			}
		}
		outfit_tags = { jester_outfit }
		weight = {
			base = -100
			modifier = {
				add = 1000
				OR = {
					portrait_jester_trigger = { CULTURE_INPUT = western }
					portrait_jester_trigger = { CULTURE_INPUT = byzantine }
					portrait_jester_trigger = { CULTURE_INPUT = northern }
				}
			}
			modifier = {
				factor = 0
				OR = {
					is_adult = no
					should_be_naked_trigger = yes
				}
			}
		}
	}

	master_assassin_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add

				gene = headgear
				template = mena_stealth
				range = { 0 1 }
			}
		}
		weight = {
			base = -100
			modifier = {
				add = 1000
				has_court_position = master_assassin_court_position
			}
			modifier = {
				factor = 0
				OR = {
					is_adult = no
					should_be_naked_trigger = yes
				}
			}
		}
	}

	#RTT headgear
	monarchs_journey_late_unlock = {
		dna_modifiers = {
			accessory = {
				mode = add

				gene = headgear
				template = monarchs_journey_unleashed
				range = { 0 1 } # For the randomness to work correctly
			}
		}

		weight = {
			base = -100
			modifier = {
				add = 110
				current_date >= 1300.1.1
				OR = {
					portrait_western_clothing_trigger = yes
					portrait_western_clothing_spouse_trigger = yes
				}
				OR = {
					AND = {
						is_lowborn = no
						is_female = yes
					}
					AND = {
						government_has_flag = government_is_republic
						highest_held_title_tier <= tier_barony
					}
				}
			}
		}
	}

	hajj_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mena_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 500
				exists = this
				OR = {
					portrait_ep2_hajj_clothes_trigger = yes
					portrait_ep2_ihram_clothes_trigger = yes
				}
			}
		}
	}

	# EP2 - WEDDINGS

	wedding_western_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_wedding
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		outfit_tags = { spouse_outfit }
		weight = {
			base = 0
			modifier = {
				add = 1000
				has_ep2_dlc_trigger = yes
				portrait_ep2_wedding_clothes_trigger = yes
				OR = {
					portrait_western_clothing_trigger = yes
					portrait_northern_clothing_trigger = yes
				}
			}
		}
	}

	wedding_mena_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = mena_wedding
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		outfit_tags = { spouse_outfit }
		weight = {
			base = 0
			modifier = {
				add = 1000
				has_ep2_dlc_trigger = yes
				portrait_ep2_wedding_clothes_trigger = yes
				OR = {
					portrait_mena_clothing_trigger = yes
					portrait_african_clothing_trigger = yes
					portrait_indian_clothing_trigger = yes
					portrait_steppe_clothing_trigger = yes
				}
			}
		}
	}

	wedding_byz_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = byzantine_wedding
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		outfit_tags = { spouse_outfit }
		weight = {
			base = 0
			modifier = {
				add = 1000
				has_ep2_dlc_trigger = yes
				portrait_ep2_wedding_clothes_trigger = yes
				portrait_byzantine_clothing_trigger = yes
			}
		}
	}

	## TGP - Chinese ##

	chinese_commoner_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_commoner
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = chinese
				}
				has_tgp_dlc_trigger = yes
			}
			modifier = {
				add = 21
				portrait_commoner_clothing_trigger = {
					CULTURE_INPUT = chinese
				}
				has_tgp_dlc_trigger = yes
			}
		}
	}

	chinese_nobility_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_era1_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = chinese }
			modifier = {
				add = 50
				is_merit_based_official = no
				portrait_low_nobles_clothing_trigger = {
					CULTURE_INPUT = chinese
				}
				has_tgp_dlc_trigger = yes
				NOT = { exists = global_var:chinese_fashion_change }
			}
		}
	}

	chinese_family_head_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_era2_nobility
				accessory = m_headgear_sec_tgp_chinese_nob_01
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
				is_ruler = yes
				is_landed = no
				highest_held_title_tier <= tier_duchy
				is_house_head = yes
				OR = {
					portrait_low_nobles_clothing_trigger = {
						CULTURE_INPUT = chinese
					}
					portrait_high_nobles_clothing_trigger = {
						CULTURE_INPUT = chinese
					}
				}
				has_tgp_dlc_trigger = yes
				exists = global_var:chinese_fashion_change
			}
		}
	}
	
	chinese_low_nobility_headgear_tang = { # Intentionally included as free content
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_era1_nobility
				accessory = m_headgear_sec_tgp_chinese_hi_nob_01
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				is_merit_based_official = yes
				OR = {
					liege.culture = {
						has_clothing_gfx = chinese_clothing_gfx
					}
					culture = {
						has_clothing_gfx = chinese_clothing_gfx
					}
				}
				NOT = { exists = global_var:chinese_fashion_change }
			}
		}
	}

	chinese_low_nobility_headgear_song = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_era2_nobility
				accessory = m_headgear_sec_tgp_chinese_nob_02
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				is_merit_based_official = yes
				OR = {
					liege.culture = {
						has_clothing_gfx = chinese_clothing_gfx
					}
					culture = {
						has_clothing_gfx = chinese_clothing_gfx
					}
				}
				has_tgp_dlc_trigger = yes
				exists = global_var:chinese_fashion_change
			}
		}
	}

	chinese_nobility_headgear_no_dlc = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_era1_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = chinese }
			modifier = {
				add = 51
				OR = {
					portrait_low_nobles_clothing_trigger = {
						CULTURE_INPUT = chinese
					}
					portrait_high_nobles_clothing_trigger = {
						CULTURE_INPUT = chinese
					}
				}
				has_tgp_dlc_trigger = no
			}
		}
	}

	chinese_high_nobility_headgear_tang = { # Intentionally included as free content
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_era1_nobility
				accessory = m_headgear_sec_tgp_chinese_hi_nob_01
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				is_merit_based_official = yes
				OR = {
					liege.culture = {
						has_clothing_gfx = chinese_clothing_gfx
					}
					culture = {
						has_clothing_gfx = chinese_clothing_gfx
					}
				}
				NOT = { exists = global_var:chinese_fashion_change }
			}
		}
	}

	chinese_high_nobility_headgear_song = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_era2_nobility
				accessory = m_headgear_sec_tgp_chinese_nob_02
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				is_merit_based_official = yes
				OR = {
					liege.culture = {
						has_clothing_gfx = chinese_clothing_gfx
					}
					culture = {
						has_clothing_gfx = chinese_clothing_gfx
					}
				}
				has_tgp_dlc_trigger = yes
				exists = global_var:chinese_fashion_change
			}
		}
	}

	chinese_royalty_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
				portrait_royalty_trigger = {
					CULTURE_INPUT = chinese
				}
				has_tgp_dlc_trigger = yes
			}
		}
	}

	chinese_adjacent_royalty_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_royalty
				accessory = m_headgear_sec_tgp_chinese_roy_01
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
				top_liege = this
				government_has_flag = government_has_merit
				NOT = {
					government_has_flag = government_is_celestial
				}
				OR = {
					portrait_royalty_trigger = {
						CULTURE_INPUT = chinese
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = korean
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = viet
					}
				}
				has_tgp_dlc_trigger = yes
			}
		}
	}

	chinese_adjacent_royalty_headgear_era_2 = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_imperial
				accessory = m_headgear_sec_tgp_chinese_imp_02
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
				top_liege = this
				government_has_flag = government_has_merit
				NOT = {
					government_has_flag = government_is_celestial
				}
				OR = {
					portrait_royalty_trigger = {
						CULTURE_INPUT = chinese
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = korean
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = viet
					}
				}
				has_tgp_dlc_trigger = yes
				exists = global_var:chinese_fashion_change
			}
		}
	}

	chinese_adjacent_imperial_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_imperial
				accessory = m_headgear_sec_tgp_chinese_imp_02
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
				top_liege = this
				highest_held_title_tier = tier_empire
				government_has_flag = government_has_merit
				NOT = {
					government_has_flag = government_is_celestial
				}
				OR = {
					portrait_royalty_trigger = {
						CULTURE_INPUT = chinese
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = korean
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = viet
					}
				}
				has_tgp_dlc_trigger = yes
				exists = global_var:chinese_fashion_change
			}
		}
	}
	
	chinese_imperial_headgear_tang = { # Intentionally included as free content
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_imperial
				accessory = m_headgear_sec_tgp_chinese_imp_02
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 110
				primary_title ?= title:h_pandaria
				NOT = { exists = global_var:chinese_fashion_change }
			}
			modifier = {
				add = 100
				OR = {
					AND = {
						portrait_imperial_trigger = {
							CULTURE_INPUT = chinese
						}
						NOT = { 
							culture = { has_clothing_gfx = korean_clothing_gfx } 
						}
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = korean
					}
					AND = {
						portrait_royalty_trigger = {
							CULTURE_INPUT = chinese
						}
						top_liege = this
					}
				}
				NOT = { primary_title ?= title:h_pandaria }
			}
			modifier = {
				add = 110
				OR = {
					primary_title ?= title:h_pandaria
					portrait_imperial_nobles_headgear_trigger = {
						CULTURE_INPUT = korean
					}
				}
				has_tgp_dlc_trigger = no
			}
		}
	} 

	chinese_imperial_headgear_song = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_chinese_era2_imperial
				accessory = m_headgear_sec_tgp_chinese_imp_01
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 110
				primary_title ?= title:h_pandaria
				has_tgp_dlc_trigger = yes
				exists = global_var:chinese_fashion_change
			}
		}
	} 

	## TGP - Japanese ##

	tgp_japanese_commoner_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_japanese_commoner
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = japanese
				}
				has_tgp_dlc_trigger = yes
			}
			modifier = {
				add = 21
				portrait_commoner_clothing_trigger = {
					CULTURE_INPUT = japanese
				}
				has_tgp_dlc_trigger = yes
			}
		}
	}

	tgp_japanese_low_nobility_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_japanese_nobility
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				portrait_low_nobles_clothing_trigger = {
					CULTURE_INPUT = japanese
				}
				has_tgp_dlc_trigger = yes
			}
		}
	}

	tgp_japanese_high_nobility_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_japanese_high_nobility
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				portrait_high_nobles_headgear_trigger = {
					CULTURE_INPUT = japanese
				}
				has_tgp_dlc_trigger = yes
			}
		}
	}

	japanese_royalty_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_japanese_royalty
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				portrait_royalty_trigger = {
					CULTURE_INPUT = japanese
				}
				has_tgp_dlc_trigger = yes
			}
		}
	}

	japanese_shogun_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_japanese_shogun
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 151
				government_is_japanese_trigger = yes
				OR = {
					tgp_is_ceremonial_regent_trigger = yes # Not 'actual' ruler
					AND = {
						top_liege = this
						highest_held_title_tier = tier_kingdom
					}
					trigger_if = {
						limit = { exists = top_liege }
						is_councillor_of = top_liege
					}
					AND = {
						is_house_head = yes
						is_landed = yes
						liege = top_liege
						has_same_government = top_liege
						trigger_if = {
							limit = { exists = top_liege }
							is_councillor_of = top_liege
						}
						trigger_else = { always = no }
					}
				}
				NOT = { tgp_is_ceremonial_liege_trigger = yes }
				has_tgp_dlc_trigger = yes
			}
		}
	}

	japanese_imperial_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_japanese_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				portrait_imperial_nobles_headgear_trigger = {
					CULTURE_INPUT = japanese
				}
				has_tgp_dlc_trigger = yes
			}
			modifier = {
				add = 1000 # Warcraft
				#has_title = title:k_chrysanthemum_throne
				portrait_imperial_nobles_headgear_trigger = {
					CULTURE_INPUT = japanese
				}
			}
		}
	}   

	## TGP - Korean ##

	tgp_korean_nobility_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_korean_nobility
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				is_merit_based_official = yes
				OR = {
					portrait_low_nobles_clothing_trigger = {
						CULTURE_INPUT = korean
					}
					portrait_high_nobles_headgear_trigger = {
						CULTURE_INPUT = korean
					}
				}
				has_tgp_dlc_trigger = yes
			}
		}
	}

	korean_imperial_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_korean_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				portrait_imperial_nobles_headgear_trigger = {
					CULTURE_INPUT = korean
				}
				has_tgp_dlc_trigger = yes
			}
		}
	}  

	## TGP - Khmer ##

	tgp_khmer_low_nobility_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_southeast_nobility
				range = { 0 1 }
			}
			
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				OR = {
					portrait_high_nobles_headgear_trigger = {
						CULTURE_INPUT = southeast_asian
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = southeast_asian
					}
					portrait_imperial_trigger = {
						CULTURE_INPUT = southeast_asian
					}
				}
				has_tgp_dlc_trigger = yes
				has_ep2_dlc_trigger = yes
			}
		}
	}

	tgp_khmer_high_nobility_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_southeast_nobility
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				has_tgp_dlc_trigger = yes
				trigger_if = {
					limit = { has_ep2_dlc_trigger = yes }
					OR = {
						portrait_high_nobles_headgear_trigger = {
							CULTURE_INPUT = southeast_asian
						}
						portrait_royalty_trigger = {
							CULTURE_INPUT = southeast_asian
						}
					}
				}
				trigger_else = {
					OR = {
						portrait_high_nobles_headgear_trigger = {
							CULTURE_INPUT = southeast_asian
						}
						portrait_royalty_trigger = {
							CULTURE_INPUT = southeast_asian
						}
						portrait_imperial_trigger = {
							CULTURE_INPUT = southeast_asian
						}
					}
				}
			}
		}
	}

	tgp_khmer_royal_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_southeast_royal
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 51
				has_tgp_dlc_trigger = yes
				has_ep2_dlc_trigger = yes
				OR = {
					portrait_high_nobles_headgear_trigger = {
						CULTURE_INPUT = southeast_asian
					}
					portrait_royalty_trigger = {
						CULTURE_INPUT = southeast_asian
					}
				}
			}
		}
	}

	tgp_khmer_imperial_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_southeast_imperial
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 200
				has_tgp_dlc_trigger = yes
				has_ep2_dlc_trigger = yes
				portrait_imperial_trigger = {
					CULTURE_INPUT = southeast_asian
				}
			}
		}
	}

	## TGP - Ainu ##

	tgp_ainu_commoner_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = tgp_ainu_commoner
				range = { 0 1 }
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 200
				has_tgp_dlc_trigger = yes
				portrait_ainu_clothing_trigger = yes
			}
		}
	}

	###########################################
	############# W A R C R A F T #############
	###########################################

	# SCOURGE
	scourge_high_cultists = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = scourge_high_cultist_headgears
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
				exists = this
				portrait_scourge_clothing_trigger = yes
				portrait_wear_no_armor_trigger = yes
				exists = liege_or_court_owner.cp:councillor_spymaster
				this = liege_or_court_owner.cp:councillor_spymaster
			}
		}
	}
	scourge_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = scourge_cultist_headgears
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = scourge
				}
			}
			modifier = {
				add = 20
				portrait_commoner_clothing_trigger = {
					CULTURE_INPUT = scourge
				}
			}
			
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}
	scourge_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#modifier = {
			#	add = 50
			#	OR = {
			#		AND = {
			#			count_clothing_trigger = yes
			#			portrait_scourge_clothing_trigger = yes
			#		}
			#		AND = {
			#			exists = primary_spouse
			#			takes_spouse_clothing_trigger = yes
			#			primary_spouse = {
			#				count_clothing_trigger = yes
			#				portrait_scourge_clothing_spouse_trigger = yes
			#			}
			#		}
			#	}
			#} #Old, just in case
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = scourge }
			modifier = {
				add = 50
				portrait_low_nobles_clothing_trigger = {
					CULTURE_INPUT = scourge
				}
			}
		}
	}
	scourge_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = western_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				#OR = {
				#	AND = {
				#		duke_or_highter_clothing_trigger = yes
				#		portrait_scourge_clothing_trigger = yes
				#	}
				#	AND = {
				#		exists = primary_spouse
				#		takes_spouse_clothing_trigger = yes
				#		primary_spouse = {
				#			duke_or_highter_clothing_trigger = yes
				#			portrait_scourge_clothing_spouse_trigger = yes
				#		}
				#	}
				#} #Old, just in case
				portrait_high_nobles_headgear_trigger = {
					CULTURE_INPUT = scourge
				}
			}
			
		}
	}

	# TROLL
	troll_royalty = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = religious_african_high
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				peasant_clothing_trigger = no
				#OR = {
				#	AND = {
				#		king_clothing_trigger = yes
				#		portrait_troll_clothing_trigger = yes
				#	}
				#	AND = {
				#		exists = primary_spouse
				#		takes_spouse_clothing_trigger = yes
				#		primary_spouse = {
				#			king_clothing_trigger = yes
				#			portrait_troll_clothing_spouse_trigger = yes
				#		}
				#	}
				#} #OLD, just in case
				portrait_royalty_trigger = {
					CULTURE_INPUT = troll
				}
			}
		}
	}
	troll_imperial = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = zandalari_imperial
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				peasant_clothing_trigger = no
				#OR = {
				#	AND = {
				#		emperor_clothing_trigger = yes
				#		portrait_troll_clothing_trigger = yes
				#	}
				#	AND = {
				#		exists = primary_spouse
				#		takes_spouse_clothing_trigger = yes
				#		primary_spouse = {
				#			emperor_clothing_trigger = yes
				#			portrait_troll_clothing_spouse_trigger = yes
				#		}
				#	}
				#} #OLD, just in case
				portrait_imperial_trigger = {
					CULTURE_INPUT = troll
				}
			}
		}
	}

	### HIGH ELVES
	high_elven_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = high_elven_crowns
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 50
				exists = this
				OR = {
					AND = {
						duke_or_highter_clothing_trigger = yes
						OR = {
							portrait_high_elven_clothing_trigger = yes
							portrait_night_elven_clothing_trigger = yes
						}
					}
					AND = {
						exists = primary_spouse
						takes_spouse_clothing_trigger = yes
						primary_spouse = {
							duke_or_highter_clothing_trigger = yes
							OR = {
								portrait_high_elven_clothing_spouse_trigger = yes
								portrait_night_elven_clothing_spouse_trigger = yes
							}
						}
					}
				}
			}
		}
	}

	### GOBLINS
	goblin_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = goblin_top_hats
				range = { 0 1 } # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0
			modifier = {
				add = 50
				portrait_high_nobles_headgear_trigger = {
					CULTURE_INPUT = goblin
				}
			}
			modifier = {
				add = 80
				exists = this
				portrait_goblin_clothing_trigger = yes
				duke_or_highter_clothing_trigger = yes
			}
		}
	}

	# PYGMY
	pygmy_commoners = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = pygmy_common
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#modifier = {
			#	add = 50
			#	#commoner_clothing_trigger = yes
			#	#portrait_pygmy_clothing_trigger = yes
			#	
			#}
			modifier = {
				add = 80
				portrait_commoner_headgear_fallback_trigger = {
					CULTURE_INPUT = pygmy
				}
			}
			modifier = {
				add = 20
				portrait_commoner_clothing_trigger = {
					CULTURE_INPUT = pygmy
				}
			}
			# Warcraft
			modifier = {
				factor = 0
				prefer_no_lowborn_headgear = yes
			}
		}
	}
	pygmy_low_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = pygmy_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#modifier = {
			#	add = 50
			#	OR = {
			#		AND = {
			#			count_clothing_trigger = yes
			#			portrait_pygmy_clothing_trigger = yes
			#		}
			#		AND = {
			#			exists = primary_spouse
			#			takes_spouse_clothing_trigger = yes
			#			primary_spouse = {
			#				count_clothing_trigger = yes
			#				portrait_pygmy_clothing_spouse_trigger = yes
			#			}
			#		}
			#	}
			#}
			court_fashion_level_4_headgear_modifier = { INPUT_PARAMETER = pygmy }
			modifier = {
				add = 50
				portrait_low_nobles_clothing_trigger = {
					CULTURE_INPUT = pygmy
				}
			}
		}
	}
	pygmy_high_nobles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = pygmy_high_nobility
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			#modifier = {
			#	add = 50
			#	OR = {
			#		AND = {
			#			duke_or_highter_clothing_trigger = yes
			#			portrait_pygmy_clothing_trigger = yes
			#		}
			#		AND = {
			#			exists = primary_spouse
			#			takes_spouse_clothing_trigger = yes
			#			primary_spouse = {
			#				duke_or_highter_clothing_trigger = yes
			#				portrait_pygmy_clothing_spouse_trigger = yes
			#			}
			#		}
			#	}
			#}
			modifier = {
				add = 50
				portrait_high_nobles_headgear_trigger = {
					CULTURE_INPUT = pygmy
				}
			}
		}
	}

	### GNOMES
	gnome_goggles = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = gnome_goggles
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = { #Dont know how to adapt 1.9 this lmao, but should work anyway -mayonez
			base = 0
			modifier = {
				add = 30
				exists = this
				portrait_gnomish_clothing_trigger = yes
				is_exempt_from_gnome_goggles_trigger = yes
			}
			modifier = {
				add = 100
				exists = this
				portrait_gnomish_clothing_trigger = yes
				duke_or_highter_clothing_trigger = yes
				is_exempt_from_gnome_goggles_trigger = yes
			}
			modifier = {
				add = 120
				exists = this
				religious_clothing_trigger = yes
				religious_gnomish_clothing_trigger = yes
				is_exempt_from_gnome_goggles_trigger = yes
			}
		}
	}

	### ORCISH
	orc_war_nobility_headgear = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = orc_war_nobility_headgear
				value = 0.6
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		outfit_tags = { military_outfit }
		weight = {
			base = 0
			modifier = {
				add = 60
				portrait_war_nobles_helmet_trigger = {
					CULTURE_INPUT = orcish
				}
				OR = {
					portrait_commoner_armor_trigger = { 
						CULTURE_INPUT = orcish
					}
					portrait_low_nobles_armor_trigger = { 
						CULTURE_INPUT = orcish
					}
				}
			}
			modifier = {
                factor = 0
				OR = {
                	is_rexxar_trigger = yes
					is_blackhand_trigger = yes
					is_durotan_trigger = yes
					is_thrall_trigger = yes
					is_guldan_trigger = yes
					is_garona_trigger = yes
					is_orgrim_trigger = yes
					is_kilrogg_trigger = yes
					is_urukal_trigger = yes
					is_dalrend_trigger = yes
					is_maim_trigger = yes
					is_griselda_trigger = yes
					is_grommash_trigger = yes
					is_garrosh_trigger = yes
					is_drekthar_trigger = yes
					is_draka_trigger = yes
					is_nazgrel_trigger = yes
					is_nerzhul_trigger = yes
				}
            }
		}
	}

	# TERENAS CROWN
	terenas_crown = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = terenas_crown
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 101
				exists = this
				has_primary_title = title:e_lordaeron
			}
			modifier = {
				add = 140
				exists = this
				any_equipped_character_artifact = {
					has_variable = terenas_crown
				}
			}
		}
	}

	# REXXAR MASK
	rexxar_mask = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = rexxar_mask
				range = { 0 1 } # For the randomness to work correctly
			}
		}		
		weight = {
			base = 0
			modifier = {
				add = 1000
				is_rexxar_trigger = yes
			}
		}
	}

	# Elisande hat
	elisande_hat = {
        dna_modifiers = {
            accessory = {
				mode = add
				gene = headgear
				template = elisande_hat
				value = 1
			}
        }
        weight = {
            base = 0
            modifier = {
                add = 100
                is_elisande_trigger = yes
            }
        }
    }

	### DWARVEN

	# Dwarf Highcrown
	dwarf_highcrown = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dwarf_highcrown
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
				OR = {
					has_primary_title = title:k_ironforge
					has_primary_title = title:e_khaz_modan
				}
			}
		}
	}

	# Dark Dwarf Highcrown
	darkdwarf_highcrown = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = darkdwarf_highcrown
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 110
				OR = {
					has_primary_title = title:k_shadowforge
					has_primary_title = title:e_dark_iron
				}
			}
		}
	}

	# Dwarf Duke Crown
	dwarf_crown_duke = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dwarf_crown_duke
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 110
				portrait_dwarven_clothing_trigger = yes
				highest_held_title_tier = tier_duchy
				NOT = {has_culture = culture:wildhammer}
			}
		}
	}

	# Dwarf Count Crown
	dwarf_crown_duke = {
		dna_modifiers = {
			accessory = {
				mode = add
				gene = headgear
				template = dwarf_crown_count
				range = { 0 1 } # For the randomness to work correctly
			}
		}
		weight = {
			base = 0
			modifier = {
				add = 100
				portrait_dwarven_clothing_trigger = yes
				highest_held_title_tier = tier_county
				NOT = {has_culture = culture:wildhammer}
			}
		}
	}
	sylvanas_hood_undead = {
        dna_modifiers = {
            accessory = {
				mode = add
				gene = headgear
				template = hero_headgear
				accessory = sylvanas_hood
				value = 1
			}
        }
        weight = {
            base = 0
            modifier = {
                add = 1000
                is_sylvanas_trigger = yes
				has_trait = being_undead
            }
        }
    }
	medivh_hood = {
        dna_modifiers = {
            accessory = {
				mode = add
				gene = headgear
				template = hero_headgear
				accessory = male_headgear_human_medivh_hood
				value = 1 
			}
        }
        weight = {
            base = 0
            modifier = {
                add = 5000
                is_medivh_trigger = yes
            }
        }
    }
	tophat = {
        dna_modifiers = {
            accessory = {
				mode = add
				gene = headgear
				template = m_gilnean_tophat
				range = { 0 1 }
			}
        }
        weight = {
            base = 0
            modifier = {
                add = 5000
                is_genn_trigger = yes
            }
        }
    }


}


